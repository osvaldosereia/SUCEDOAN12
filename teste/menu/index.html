<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Dona Antonia v9.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; }
        iframe { border: none; width: 100%; height: calc(100% - 48px); /* 48px é a altura da topbar */ display: block; }
        
        /* Estilização da Navegação em Texto Puro */
        .nav-item { 
            cursor: pointer; 
            padding: 0 1rem; 
            height: 100%; 
            display: flex; 
            align-items: center; 
            font-size: 0.8rem; 
            font-weight: 600; 
            color: #94a3b8; 
            transition: all 0.2s;
            text-transform: uppercase; /* Garante letra maiúscula */
            letter-spacing: 0.05em;
            position: relative;
        }

        .nav-item:hover { color: #f1f5f9; }
        .nav-item.active { color: #3b82f6; } /* Destaque azul apenas no texto */

        /* Separador '|' via Pseudo-elemento */
        .nav-item:not(:last-child)::after {
            content: '|';
            position: absolute;
            right: 0;
            color: #334155; /* Cor discreta para o separador */
            font-weight: 400;
        }

        /* Ajuste para o separador não colar no texto se o padding for pequeno */
        .nav-item {
            margin-right: 2px;
        }
    </style>
    <!-- Ícones Lucide (Apenas para utilitários do header) -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-slate-900 flex flex-col">

    <!-- TOPBAR ESTREITA -->
    <header class="h-12 bg-slate-900 text-white flex items-center justify-between px-4 shadow-lg shrink-0 z-50 border-b border-slate-800">
        <div class="flex items-center gap-8 h-full">
            <!-- BRANDING -->
            <div class="font-bold text-lg tracking-wider flex items-center gap-2 whitespace-nowrap">
                <span class="bg-indigo-600 text-white px-1.5 rounded text-xs py-0.5">SYS</span>
                DONA ANTONIA
            </div>
            
            <!-- NAVEGAÇÃO (Sem ícones, com separadores) -->
            <nav class="flex h-full items-center overflow-x-auto no-scrollbar" id="main-nav">
                <a data-src="https://donaantonia.com.br/teste/1" class="nav-item" onclick="loadTab(this)">
                    CLIENTE
                </a>
                <a data-src="https://donaantonia.com.br/teste/2" class="nav-item" onclick="loadTab(this)">
                    PRODUTO
                </a>
                <a data-src="https://donaantonia.com.br/teste/3" class="nav-item" onclick="loadTab(this)">
                    VENDA
                </a>
                <a data-src="https://donaantonia.com.br/teste/4" class="nav-item" onclick="loadTab(this)">
                    EXPEDIÇÃO
                </a>
                <a data-src="https://donaantonia.com.br/teste/5" class="nav-item" onclick="loadTab(this)">
                    Estoque
                </a>
                <a data-src="https://donaantonia.com.br/teste/6" class="nav-item" onclick="loadTab(this)">
                    POS-VENDA
                </a>
                <a data-src="https://donaantonia.com.br/teste/7" class="nav-item" onclick="loadTab(this)">
                    BI
                </a>
                <a data-src="https://donaantonia.com.br/teste/8" class="nav-item" onclick="loadTab(this)">
                    Pós-Venda
                </a>
            </nav>
        </div>

        <!-- Utilitários (Mantidos para funcionalidade de sistema) -->
        <div class="flex items-center gap-4 pl-4 border-l border-slate-800">
            <div class="hidden md:flex items-center gap-2 text-xs text-slate-400 bg-slate-800 px-3 py-1 rounded-full">
                <i data-lucide="user" class="w-3 h-3"></i> Admin
            </div>
            <button onclick="forceReload()" class="text-slate-400 hover:text-white" title="Recarregar Sistema">
                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
            </button>
        </div>
    </header>

    <!-- ÁREA DO CONTEÚDO (IFRAME) -->
    <iframe id="content-frame" src="about:blank" name="content-frame"></iframe>

    <script>
        // Inicializa ícones apenas para o header utilitário
        lucide.createIcons();

        function loadTab(element) {
            if (!element) return;

            // 1. UI: Gerencia classe 'active'
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
            
            // 2. DATA: Recupera URL base
            const baseUrl = element.getAttribute('data-src');
            
            // 3. CACHE BUSTING: Adiciona timestamp para forçar versão atual
            // Verifica se a URL já tem parametros (?) ou não
            const separator = baseUrl.includes('?') ? '&' : '?';
            const timestamp = new Date().getTime();
            const finalUrl = `${baseUrl}${separator}v=${timestamp}`;
            
            // 4. LOAD: Carrega no iframe
            const iframe = document.getElementById('content-frame');
            iframe.src = finalUrl;

            // 5. PERSISTENCE: Salva a escolha do usuário
            // Usamos o 'data-src' original como ID único
            localStorage.setItem('donaAntonia_lastTab', baseUrl);
        }

        // Função para recarregar tudo forçadamente
        function forceReload() {
            // Limpa cache se necessário ou apenas recarrega a página
            window.location.reload();
        }

        // Inicialização Inteligente
        document.addEventListener('DOMContentLoaded', () => {
            const lastTabSrc = localStorage.getItem('donaAntonia_lastTab');
            let tabToLoad = null;

            // Tenta encontrar a última aba usada
            if (lastTabSrc) {
                tabToLoad = document.querySelector(`.nav-item[data-src="${lastTabSrc}"]`);
            }

            // Se não houver histórico ou a aba não existir mais, pega a primeira
            if (!tabToLoad) {
                tabToLoad = document.querySelector('.nav-item');
            }

            // Executa o carregamento
            if (tabToLoad) {
                loadTab(tabToLoad);
            } else {
                // Fallback de segurança
                document.getElementById('content-frame').srcdoc = '<div style="display:flex;justify-content:center;align-items:center;height:100%;font-family:sans-serif;color:#666;"><h1>Módulo não encontrado.</h1></div>';
            }
        });
    </script>
</body>
</html>
