<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<meta name="description" content="Super Cestas B√°sicas Dona Ant√¥nia - Qualidade e pre√ßo justo.">
<meta name="geo.region" content="BR-MT"><meta name="geo.placename" content="Cuiab√°"><meta name="theme-color" content="#ffffff">
<title>Super Cestas B√°sicas Dona Ant√¥nia</title>
<style>
:root {
    --c-p:#1e293b; --c-s:#64748b; --c-t:#94a3b8; --c-a:#F97316; --c-ok:#10B981; --c-err:#EF4444;
    --c-bg:#F8FAFC; --c-surf:#FFFFFF; --c-bd:#E2E8F0; --font:'Inter',system-ui,sans-serif;
    --rad:16px; --pill:50px; --sh-sm:0 1px 2px #0000000d; --sh-fl:0 10px 15px -3px #0000000d;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;outline:none}
body{font-family:var(--font);background:var(--c-bg);color:var(--c-p);margin:0;padding-bottom:100px;font-size:15px;line-height:1.5;min-height:100vh;-webkit-font-smoothing:antialiased}
.limit-container{max-width:1200px;margin:0 auto;width:100%}
h1,h2,h3,h4{margin:0;font-weight:700;color:var(--c-p);letter-spacing:-.02em}
button{cursor:pointer;border:none;background:0 0;font-family:inherit;font-weight:600;padding:0}
.header-wrapper{position:sticky;top:0;z-index:1000;background:#ffffffdb;backdrop-filter:blur(8px);border-bottom:1px solid var(--c-bd);transition:transform .4s cubic-bezier(.16,1,.3,1)}
.header-wrapper.hidden{transform:translateY(-100%)}
header{display:flex;align-items:center;justify-content:space-between;padding:10px 20px;min-height:60px}
.header-left,.header-actions{display:flex;align-items:center;gap:12px}
.header-actions{gap:8px}
.logo{width:36px;height:36px;border-radius:50%;object-fit:cover;box-shadow:var(--sh-sm)}
.page-title{font-size:.9rem;font-weight:700;line-height:1.1}
.btn-header-icon{width:36px;height:36px;border-radius:50%;background:#F1F5F9;color:var(--c-s);display:flex;align-items:center;justify-content:center;transition:.2s}
.btn-header-icon:hover{background:#E2E8F0;color:var(--c-p)}
.whatsapp{background:#DCFCE7;color:#16A34A}
/* STICKY SEARCH & SELECTOR */
.sticky-stack{position:sticky;top:61px;z-index:990;width:100%;background:var(--c-bg);padding:10px 20px;transition:top .4s ease;box-shadow:0 4px 10px -5px #0000001a}
.header-wrapper.hidden+main .sticky-stack{top:0}
.search-wrapper-styled{display:flex;flex-direction:column;gap:10px;width:100%}
.search-box{width:100%;padding:14px 16px 14px 45px;border:2px solid var(--c-a);border-radius:12px;background:#fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23F97316' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E") no-repeat 14px center;font-size:1rem;color:var(--c-p);box-shadow:0 4px 12px rgba(249,115,22,0.15);transition:.2s}
.search-box:focus{box-shadow:0 0 0 4px rgba(249,115,22,0.2)}
.btn-clear-search{position:absolute;right:16px;top:15px;color:var(--c-s);padding:5px;display:none;z-index:10}
/* CUSTOM SELECTOR */
.custom-select-container{position:relative;width:100%}
.custom-select-trigger{background:#fff;border:1px solid var(--c-bd);padding:12px;border-radius:10px;font-size:.9rem;font-weight:700;color:var(--c-p);display:flex;justify-content:space-between;align-items:center;cursor:pointer;box-shadow:var(--sh-sm)}
.custom-select-trigger:after{content:'‚ñº';font-size:.7rem;color:var(--c-s)}
.custom-select-menu{position:absolute;top:100%;left:0;width:100%;background:#fff;border:1px solid var(--c-bd);border-radius:10px;margin-top:5px;max-height:300px;overflow-y:auto;z-index:100;box-shadow:var(--sh-fl);display:none;animation:fadeIn .2s}
.custom-select-menu.open{display:block}
.custom-option{padding:12px 15px;border-bottom:1px solid #f1f5f9;font-size:.9rem;color:var(--c-s);cursor:pointer;transition:.2s}
.custom-option:hover,.custom-option:active{background:#f8fafc;color:var(--c-p);padding-left:20px}
/* LAYOUT ELEMENTS */
.hero-section{padding:10px 20px} .hero-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.hero-banner-mini{background:#fff;padding:10px;border-radius:12px;border:1px solid var(--c-bd);font-size:.75rem;color:var(--c-s);box-shadow:var(--sh-sm)}
.hero-banner-mini strong{font-size:.85rem;color:var(--c-p);display:block}
.section-header{padding:15px 20px 10px;display:flex;justify-content:space-between;align-items:baseline}
.section-title{font-size:1rem;font-weight:800} .section-subtitle{font-size:.75rem;color:var(--c-s)}
.carousel-container{margin-bottom:15px;position:relative}
.carousel-container::after{content:'';position:absolute;right:0;top:0;bottom:0;width:40px;background:linear-gradient(to right,transparent,var(--c-bg));pointer-events:none;z-index:5}
.basket-area-carousel::after{background:linear-gradient(to right,transparent,#fff)!important}
.carousel-track{display:flex;overflow-x:auto;padding:0 20px 10px;gap:12px;-webkit-overflow-scrolling:touch}
.carousel-track::-webkit-scrollbar{display:none}
@keyframes bounce-hint{0%,100%{transform:translateX(0)}50%{transform:translateX(-20px)}}
.bounce-anim .carousel-track{animation:bounce-hint 1.2s ease .5s 1}
.carousel-arrow{position:absolute;top:50%;transform:translateY(-50%);width:32px;height:32px;border-radius:50%;background:#fff;border:1px solid var(--c-bd);box-shadow:var(--sh-fl);z-index:10;display:none;align-items:center;justify-content:center;font-size:1rem;color:var(--c-p)}
.arrow-left{left:10px} .arrow-right{right:10px} @media(hover:hover){.carousel-arrow{display:flex}}
.cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:10px 20px 20px}
.cat-btn-big{background:#fff;border:1px solid var(--c-bd);border-radius:12px;padding:15px 10px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:.95rem;font-weight:700;color:var(--c-p);box-shadow:var(--sh-sm);min-height:60px;cursor:pointer}
.cat-btn-big:active{transform:scale(.96);background:#f1f5f9}
.modal-prod-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:5px}
.prod-card,.basket-item-card,.cesta-mini-card{background:#fff;border-radius:14px;padding:10px;display:flex;flex-direction:column;box-shadow:0 4px 6px -1px #0000000d;position:relative;border:1px solid transparent;content-visibility:auto}
.prod-card{flex:0 0 150px} .basket-item-card{flex:0 0 130px;padding:8px;border:1px solid #f1f5f9}
.cesta-mini-card{flex:0 0 260px;padding:0;overflow:hidden;box-shadow:var(--sh-fl);transition:transform .2s}
.cesta-mini-card:active{transform:scale(.98)}
.cesta-mini-img{width:100%;height:150px;object-fit:cover;background:#f1f5f9}
.cesta-mini-content{padding:14px;display:flex;flex-direction:column;gap:4px}
.prod-img{width:100%;aspect-ratio:1;object-fit:contain;margin-bottom:6px;mix-blend-mode:multiply}
.prod-validity{font-size:.65rem;color:var(--c-t);margin-bottom:2px}
.prod-name{font-size:.8rem;line-height:1.3;height:5.2em;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;-webkit-box-orient:vertical;color:var(--c-p);margin-bottom:6px;font-weight:500}
.basket-item-card .prod-name{height:2.8em;-webkit-line-clamp:2;font-size:.75rem}
.prod-price{font-size:1rem;font-weight:700;color:var(--c-a);margin-top:auto}
.qty-control{display:flex;justify-content:space-between;align-items:center;background:#F1F5F9;border-radius:10px;margin-top:8px;padding:2px;height:30px}
.btn-q{width:26px;height:26px;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 1px 2px #0000001a}
.val-q{font-weight:600;font-size:.85rem;width:24px;text-align:center}
.btn-add-big{margin-top:8px;width:100%;height:30px;background:var(--c-bg);color:var(--c-s);border-radius:10px;font-size:1.2rem;display:flex;align-items:center;justify-content:center;border:1px solid var(--c-bd)}
.btn-add-big:active,.btn-add-big:hover{background:var(--c-p);color:#fff}
#selected-basket-area{margin:15px 20px;background:#fff;border-radius:var(--rad);box-shadow:0 4px 6px #0000000d;animation:fadeIn .3s}
.basket-intro-msg{padding:12px;text-align:center;background:#F0FDF4;color:#166534;font-size:.85rem;border-bottom:1px dashed #BBF7D0}
.basket-counter{text-align:center;font-size:.75rem;color:var(--c-s);background:#f8fafc;padding:4px 10px;border-radius:20px;margin:0 auto 8px;width:fit-content;border:1px solid var(--c-bd)}
.separator-zone{padding:15px;text-align:center}
.checkout-bar{position:fixed;bottom:0;left:0;width:100%;background:#fffffffa;backdrop-filter:blur(10px);padding:8px 16px 12px;z-index:1001;border-top:1px solid var(--c-bd);box-shadow:0 -4px 20px #00000014;display:flex;align-items:center;gap:10px}
.checkout-info{display:flex;flex-direction:column}
.checkout-label{font-size:.7rem;color:var(--c-s);text-transform:uppercase;font-weight:700}
.checkout-total{font-size:1.1rem;font-weight:800;letter-spacing:-.5px}
.btn-main-action{flex-grow:1;padding:10px;border-radius:10px;max-width:200px;background:#25D366;color:#fff;font-weight:700;font-size:.9rem;box-shadow:0 4px 10px #25d3664d;display:flex;align-items:center;justify-content:center;gap:6px}
.btn-trash{width:36px;height:36px;border-radius:50%;background:#FEF2F2;color:var(--c-err);border:1px solid #FECACA;display:flex;align-items:center;justify-content:center;flex-shrink:0}
#toast-container{position:fixed;top:70px;left:50%;transform:translateX(-50%);z-index:2000;display:flex;flex-direction:column;gap:10px;width:90%;max-width:400px;pointer-events:none}
.toast{background:var(--c-p);color:#fff;padding:12px 20px;border-radius:50px;box-shadow:0 10px 25px #00000033;font-size:.85rem;font-weight:600;display:flex;align-items:center;gap:10px;justify-content:center;animation:slideInTop .4s}
@keyframes slideInTop{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
dialog{border:none;border-radius:20px;width:92%;max-width:420px;padding:0;box-shadow:0 25px 50px -12px #00000040;background:#fff;animation:modalPop .3s}
@keyframes modalPop{from{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}
dialog::backdrop{background:#1e293bb3;backdrop-filter:blur(4px)}
.modal-body{padding:25px 20px;text-align:center}
.modal-title{font-size:1.2rem;margin-bottom:2px;text-transform:uppercase;font-weight:800}
.btn-modal{width:100%;padding:12px;border-radius:10px;font-weight:700;margin-bottom:10px;font-size:.95rem}
.btn-modal.primary{background:var(--c-ok);color:#fff;box-shadow:0 4px 10px #10b98133}
.btn-modal.secondary{background:#fff;border:2px solid var(--c-bd);color:var(--c-s)}
.coupon-box{display:flex;gap:8px;margin-bottom:15px} .coupon-input{flex-grow:1;padding:10px;border:1px solid var(--c-bd);border-radius:8px;text-transform:uppercase;font-weight:700}
.coupon-btn{padding:0 15px;background:var(--c-p);color:#fff;border-radius:8px;font-weight:700;font-size:.8rem}
#modal-image-zoom{background:0 0;box-shadow:none;width:100%;height:100%;max-width:100%}
#modal-image-zoom .modal-body{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;padding:20px;background:0 0}
#zoom-img{max-width:95vw;max-height:80vh;border-radius:12px;background:#fff;box-shadow:0 20px 50px #00000080}
@media(min-width:900px){
    .prod-card{flex:0 0 200px} .basket-item-card{flex:0 0 160px}
    .checkout-bar{max-width:600px;left:50%;transform:translateX(-50%);border-radius:20px 20px 0 0;padding:10px 20px}
    .cat-grid{grid-template-columns:repeat(4,1fr)} .modal-prod-grid{grid-template-columns:repeat(3,1fr)}
}
</style>
</head>
<body>
<div class="header-wrapper">
    <header class="limit-container">
        <div class="header-left">
            <img src="img/produtos/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" class="logo" alt="Logo">
            <div class="page-title">Super Cestas<br>Dona Ant√¥nia</div>
        </div>
        <div class="header-actions">
            <button class="btn-header-icon" onclick="$('modal-faq').showModal()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </button>
            <a href="https://wa.me/5565996813588" target="_blank" class="btn-header-icon whatsapp">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
            </a>
        </div>
    </header>
</div>
<main class="limit-container">
    <div class="hero-section">
        <div class="hero-grid">
            <div class="hero-banner-mini" onclick="showTopInfo('entrega')"><strong>Entrega Gr√°tis</strong><span>Cuiab√° e VG üöõ</span></div>
            <div class="hero-banner-mini" onclick="showTopInfo('pagamento')"><strong>Pague na Entrega</strong><span>PIX ou Cart√£o üí≥</span></div>
        </div>
    </div>
    <div id="baskets-top-container" class="bounce-anim">
        <div class="section-header"><div class="section-title">Cestas Prontas</div><div class="section-subtitle">Arraste ‚ûù</div></div>
        <div class="carousel-container">
            <div class="carousel-arrow arrow-left" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:-250,behavior:'smooth'})">‚ùÆ</div>
            <div class="carousel-track" id="cestas-scroll-list"></div>
            <div class="carousel-arrow arrow-right" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:250,behavior:'smooth'})">‚ùØ</div>
        </div>
    </div>
    <div style="padding:0 20px 10px" id="zero-mode-banner">
        <div class="hero-banner-mini" style="width:100%;padding:12px;background:#F0F9FF;border-color:#BAE6FD">
            <strong style="color:#0284C7">Monte do seu jeito!</strong><span style="color:#0369A1">M√≠nimo R$ 85,00.</span>
        </div>
    </div>
    <div id="selected-basket-area" style="display:none" class="bounce-anim">
        <div class="basket-intro-msg" id="basket-intro-msg"></div>
        <div class="carousel-container basket-area-carousel" style="padding-bottom:10px">
            <div class="carousel-arrow arrow-left" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:-200,behavior:'smooth'})">‚ùÆ</div>
            <div class="carousel-track" id="basket-list-content"></div>
            <div class="carousel-arrow arrow-right" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:200,behavior:'smooth'})">‚ùØ</div>
        </div>
        <div id="basket-count-display" class="basket-counter">0 itens</div>
    </div>
    
    <div id="ofertas-area" class="bounce-anim"></div>
    <div class="separator-zone" id="cat-separator" style="display:none"><h3 class="separator-title">Mais produtos</h3></div>
    
    <div class="sticky-stack">
        <div class="search-wrapper-styled">
            <div style="position:relative">
                 <input type="text" id="search-input" class="search-box" placeholder="O que voc√™ procura hoje?" oninput="renderCatalogo(true)">
                 <button class="btn-clear-search" id="btn-clear-search" onclick="clearSearch()">‚úï</button>
            </div>
            <div class="custom-select-container">
                <div class="custom-select-trigger" onclick="toggleCatMenu()">Navegar por Categorias</div>
                <div id="cat-menu" class="custom-select-menu"></div>
            </div>
        </div>
    </div>
    <div id="catalogo-content" style="padding-bottom:20px"></div>
    <div id="sentinel" style="height:20px;width:100%"></div>
</main>
<div class="checkout-bar">
    <button class="btn-trash" onclick="clearCart()">üóëÔ∏è</button>
    <div class="checkout-info"><div id="chk-status-text" class="checkout-label">Seu Pedido</div><div class="checkout-total" id="chk-total-val">R$ 0,00</div></div>
    <button class="btn-main-action" onclick="openCheckoutModal()"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M21 8H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2zM5 8V6a5 5 0 0 1 10 0v2"/></svg>VER CESTA</button>
</div>
<div id="toast-container"></div>
<button id="btn-view-diff-float" style="display:none" onclick="openDiffModal()"></button>
<dialog id="modal-basket-preview">
    <div class="modal-body">
        <h3 class="modal-title" id="preview-title"></h3><p class="modal-desc" id="preview-desc"></p>
        <div class="carousel-container basket-area-carousel" style="background:#F8FAFC;border-radius:12px;padding:10px 0">
            <div class="carousel-arrow arrow-left" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:-200,behavior:'smooth'})">‚ùÆ</div>
            <div class="carousel-track" id="preview-carousel-track"></div>
            <div class="carousel-arrow arrow-right" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:200,behavior:'smooth'})">‚ùØ</div>
        </div>
        <div style="margin-top:20px"><div style="margin-bottom:20px;font-size:1.8rem;font-weight:800;color:var(--c-a)" id="preview-price"></div>
            <button class="btn-modal primary" onclick="confirmBasketSelection()">QUERO ESTA CESTA</button>
            <button class="btn-modal ghost" onclick="$('modal-basket-preview').close()">Voltar</button>
        </div>
    </div>
</dialog>
<dialog id="modal-checkout">
    <div class="modal-body" style="text-align:left">
        <h3 class="modal-title" style="text-align:center">SUA CESTA</h3><div id="checkout-subtitle" class="modal-subtitle" style="text-align:center"></div>
        <div style="margin-bottom:20px;text-align:center">
            <div class="carousel-container basket-area-carousel" style="background:#F8FAFC;border-radius:12px;border:1px solid var(--c-bd)">
                 <div class="carousel-arrow arrow-left" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:-200,behavior:'smooth'})">‚ùÆ</div>
                 <div class="carousel-track" id="checkout-carousel-track"></div>
                 <div class="carousel-arrow arrow-right" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:200,behavior:'smooth'})">‚ùØ</div>
            </div>
        </div>
        <div style="text-align:right;margin-bottom:20px">
            <div style="font-size:1.4rem;font-weight:800" id="checkout-total-display"></div>
            <div style="font-size:.75rem;color:var(--c-t)">Parcele em at√© 3x sem juros</div>
        </div>
        <label style="display:block;font-size:.75rem;font-weight:700;color:var(--c-s);margin-bottom:5px">CUPOM</label>
        <div class="coupon-box"><input type="text" id="coupon-code" class="coupon-input" placeholder="C√ìDIGO"><button class="coupon-btn" onclick="applyCoupon()">OK</button></div>
        <div id="coupon-msg" style="font-size:.75rem;margin-bottom:15px;display:none"></div>
        <label style="display:block;font-size:.85rem;font-weight:700;color:var(--c-s);margin-bottom:5px">Seu Nome:</label>
        <input type="text" id="cust-name" class="search-box" style="margin-bottom:15px;padding:12px;border:1px solid var(--c-bd);background-image:none">
        <label style="display:block;font-size:.85rem;font-weight:700;color:var(--c-s);margin-bottom:5px">Pagamento:</label>
        <select id="cust-pay" class="search-box" style="margin-bottom:25px;padding:12px;border:1px solid var(--c-bd);background-image:none">
            <option>PIX</option><option>Dinheiro</option><option>Cart√£o de Cr√©dito</option><option>Cart√£o de D√©bito</option><option>Cart√£o Alimenta√ß√£o</option>
        </select>
        <button class="btn-modal primary" onclick="sendOrder()">
             <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:middle;margin-right:5px"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
             ENVIAR NO WHATSAPP
        </button>
        <button class="btn-modal secondary" onclick="$('modal-checkout').close()">Continuar Comprando</button>
    </div>
</dialog>
<dialog id="modal-diff">
    <div class="modal-body">
        <h3 class="modal-title">Altera√ß√µes</h3>
        <div id="diff-content" style="text-align:left;background:#F8FAFC;padding:15px;border-radius:12px;font-size:.9rem;max-height:50vh;overflow-y:auto"></div>
        <button class="btn-modal secondary" onclick="$('modal-diff').close()" style="margin-top:20px">Fechar</button>
    </div>
</dialog>
<dialog id="modal-faq">
    <div class="modal-body" style="text-align:left">
        <h3 class="modal-title" style="text-align:center">D√∫vidas</h3>
        <div style="background:#F8FAFC;padding:15px;border-radius:12px;margin-bottom:10px"><strong style="color:var(--c-p)">Entrega</strong><p style="color:var(--c-s);font-size:.9rem">Gr√°tis para Cuiab√° e V√°rzea Grande. At√© 24h √∫teis.</p></div>
        <div style="background:#F8FAFC;padding:15px;border-radius:12px"><strong style="color:var(--c-p)">Pagamento</strong><p style="color:var(--c-s);font-size:.9rem">PIX, Dinheiro e Cart√µes na entrega.</p></div>
        <div style="text-align:center;font-size:.9rem;color:var(--c-s);margin:20px 0"><strong>Super Cestas Dona Ant√¥nia</strong><br>(65) 99815-0975</div>
        <button class="btn-modal primary" onclick="$('modal-faq').close()">Entendi</button>
    </div>
</dialog>
<dialog id="modal-mini-info">
    <div class="modal-body"><h3 class="modal-title" id="mini-info-title"></h3><p id="mini-info-text" class="modal-desc"></p><button class="btn-modal primary" onclick="$('modal-mini-info').close()">OK</button></div>
</dialog>
<dialog id="modal-category-view">
    <div class="modal-body" style="padding:15px 10px;max-height:85vh;overflow-y:auto">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding:0 10px">
            <h3 class="modal-title" id="cat-modal-title" style="font-size:1.1rem"></h3>
            <button onclick="$('modal-category-view').close()" style="background:#F1F5F9;border-radius:50%;width:32px;height:32px">‚úï</button>
        </div>
        <div class="modal-prod-grid" id="cat-modal-grid"></div>
    </div>
</dialog>
<dialog id="modal-image-zoom" onclick="this.close()"><div class="modal-body"><img id="zoom-img" src="" alt="Zoom"></div></dialog>
<script>
const CONFIG_WHATSAPP="5565996813588",$=i=>document.getElementById(i);
let DB_PROD=[],DB_CESTAS=[],DB_COUPONS=[],STATE={cesta:null,cart:{},basePrice:0,currentTotal:0,sortType:'name',initialGap:0,mode:'zero',previewBasketId:null,appliedCoupon:null,catQueue:[],catPage:0};
let observer;
async function init(){
    try{
        const[r1,r2,r3]=await Promise.all([fetch('produtos-cesta-basica.json?v='+Date.now()),fetch('produtos.json?v='+Date.now()),fetch('cupons.json?v='+Date.now()).catch(()=>({ok:!1}))]);
        if(r1.ok)DB_CESTAS=await r1.json();
        if(r2.ok){
            let t=(await r2.text()).trim().replace(/,(\s+)?$/,"");
            DB_PROD=JSON.parse(t.startsWith('[')?t:'['+t+']').filter(x=>x.situacao==="A"&&(parseInt(x.estoque)||0)>0).map(p=>({id:String(p.id),code:String(p.codigo||p.id),name:p.nome,price:parseFloat(p.preco),stock:parseInt(p.estoque)||0,category:(p.categoria||p.Categoria||"Outros").trim(),validade:p.validade,img:`img/produtos/${p.codigo||p.id}.webp`}));
        }
        if(r3&&r3.ok)DB_COUPONS=await r3.json();
        renderBasketsTop();renderCatalogo();updateUI();
        initObserver();
    }catch(e){$('catalogo-content').innerHTML='<p style="text-align:center;padding:20px;color:#64748B">Carregando...</p>'}
}
function initObserver(){
    observer=new IntersectionObserver((e)=>{if(e[0].isIntersecting)loadMoreCats()},{rootMargin:'200px'});
    observer.observe($('sentinel'));
}
function smartTitleCase(s){
    if(!s)return"";
    return String(s).split(' ').map(w=>{
        let p="",sx="",c=w,l=c.toLowerCase();
        if(w.startsWith("**")){p="**";c=w.slice(2)}else if(w.startsWith("*")){p="*";c=w.slice(1)}
        if(c.endsWith("**")){sx="**";c=c.slice(0,-2)}else if(c.endsWith("*")){sx="*";c=c.slice(0,-1)}
        c=['pvc','tv','led','usb','ph','uva','sul','mt','vg','kg','ml'].includes(l)?l.toUpperCase():(['de','da','do','dos','das','em','por','com','sem','um','uma','uns','umas','para','pra'].includes(l)?l:(c.length<=3&&c===c.toUpperCase()?c:l.charAt(0).toUpperCase()+l.slice(1)));
        return p+c+sx;
    }).join(' ');
}
function formatText(s){return smartTitleCase(s).replace(/\*\*(.*?)\*\*/g,'<span style="font-weight:800;color:var(--c-err)">$1</span>').replace(/\*(.*?)\*/g,'<b>$1</b>')}
window.addEventListener('scroll',()=>{const h=$('header-wrapper');window.scrollY>50?document.querySelector('.header-wrapper').classList.add('hidden'):document.querySelector('.header-wrapper').classList.remove('hidden')});
function renderBasketsTop(){
    $('cestas-scroll-list').innerHTML=DB_CESTAS.map(c=>`<div class="cesta-mini-card" onclick="previewBasket('${c.id}')"><img src="${c.imagem||''}" class="cesta-mini-img" loading="lazy"><div class="cesta-mini-content"><div class="cesta-mini-name">${formatText(c.nome)}</div><div class="cesta-mini-price">${fmt(c.preco)}</div><button class="btn-cesta-select">Ver itens</button></div></div>`).join('');
}
function toggleCatMenu(){
    $('cat-menu').classList.toggle('open');
}
function scrollToCat(id){
    $('cat-menu').classList.remove('open');
    const e=$(id);if(e)window.scrollTo({top:e.getBoundingClientRect().top+window.pageYOffset-160,behavior:"smooth"});
}
function previewBasket(id){
    const c=DB_CESTAS.find(x=>String(x.id)===String(id));if(!c)return;
    STATE.previewBasketId=String(id);
    $('preview-title').innerHTML=formatText(c.nome);$('preview-price').innerText=fmt(c.preco);$('preview-desc').innerText=`${c.produtos.length} itens:`;
    $('preview-carousel-track').innerHTML=c.produtos.map(i=>{
        const p=i.split('x');if(p.length<2)return'';
        const pr=DB_PROD.find(x=>x.id===p[1].trim()||x.code===p[1].trim());
        return pr?`<div class="prod-card" style="box-shadow:none;border:1px solid #eee"><img src="${pr.img}" class="prod-img" loading="lazy">${pr.validade?`<div class="prod-validity">Val: ${pr.validade}</div>`:''}<div class="prod-name">${formatText(pr.name)}</div><div class="prod-price" style="font-size:.9rem;color:#64748B">${p[0].trim()} UNIDADE(S)</div></div>`:''
    }).join('');
    $('modal-basket-preview').showModal();
}
function confirmBasketSelection(){
    const c=DB_CESTAS.find(x=>String(x.id)===STATE.previewBasketId);if(!c)return;
    STATE.cesta=c;STATE.mode='custom';STATE.basePrice=c.preco;STATE.cart={};
    let is=0;c.produtos.forEach(i=>{
        const p=i.split('x');if(p.length<2)return;
        const pr=DB_PROD.find(x=>x.id===p[1].trim()||x.code===p[1].trim());
        if(pr){let q=Math.min(parseInt(p[0].trim()),pr.stock);STATE.cart[pr.id]=q;is+=pr.price*q}
    });
    STATE.initialGap=c.preco-is;STATE.appliedCoupon=null;
    $('modal-basket-preview').close();$('zero-mode-banner').style.display='none';$('selected-basket-area').style.display='block';$('cat-separator').style.display='block';
    $('basket-intro-msg').innerHTML=`Cesta <strong>${formatText(c.nome)}</strong> ativada.`;
    renderActiveBasketList();updateUI();renderCatalogo();$('btn-view-diff-float').style.display='flex';
    showToast(`Cesta carregada!`,'s');setTimeout(()=>$('selected-basket-area').scrollIntoView({behavior:'smooth',block:'start'}),100);
}
function renderActiveBasketList(){
    const el=$('basket-list-content'),ids=Object.keys(STATE.cart);
    if(!ids.length){el.innerHTML='<p style="text-align:center;color:#64748B;padding:10px;width:100%">Vazia.</p>';return}
    el.innerHTML=ids.sort((a,b)=>{const pa=DB_PROD.find(x=>x.id===a),pb=DB_PROD.find(x=>x.id===b);return pa&&pb?pa.name.localeCompare(pb.name):0}).map(pid=>{
        const p=DB_PROD.find(x=>x.id===pid);if(!p)return'';
        return `<div class="basket-item-card"><img src="${p.img}" class="prod-img" loading="lazy" onclick="openImageZoom('${p.img}')">${p.validade?`<div class="prod-validity">Val: ${p.validade}</div>`:''}<div class="prod-name">${formatText(p.name)}</div><div class="prod-price">${fmt(p.price)}</div><div class="qty-control" style="margin-top:auto"><button class="btn-q" onclick="upd('${pid}',-1)">-</button><span class="val-q qty-${pid}">${STATE.cart[pid]}</span><button class="btn-q" onclick="upd('${pid}',1)" style="color:var(--c-ok)">+</button></div></div>`
    }).join('');
}
function clearCart(){
    if(!Object.keys(STATE.cart).length)return showToast("Vazio.",'r');
    if(!confirm("Limpar carrinho?"))return;
    STATE.cart={};STATE.mode='zero';STATE.cesta=null;STATE.basePrice=0;STATE.initialGap=0;STATE.appliedCoupon=null;
    $('selected-basket-area').style.display='none';$('cat-separator').style.display='none';$('zero-mode-banner').style.display='block';
    updateUI();renderCatalogo();$('btn-view-diff-float').style.display='none';showToast("Limpo.",'r');
}
function upd(pid,d){
    const p=DB_PROD.find(x=>x.id===pid),cq=STATE.cart[pid]||0;
    if(d>0&&cq>=p.stock)return showToast("Estoque limite!", "r");
    STATE.cart[pid]=cq+d; if(STATE.cart[pid]<=0)delete STATE.cart[pid];
    if(STATE.appliedCoupon){
        let t=Object.entries(STATE.cart).reduce((a,[i,q])=>{const x=DB_PROD.find(z=>z.id===i);return a+(x?x.price*q:0)},0)+(STATE.initialGap||0);
        if(t<STATE.appliedCoupon.minimo){STATE.appliedCoupon=null;showToast("Cupom removido","r")}
    }
    updateUI();if($('selected-basket-area').style.display!=='none')renderActiveBasketList();
    document.querySelectorAll(`.qty-${pid}`).forEach(e=>e.innerText=STATE.cart[pid]||0);
    document.querySelectorAll(`.ctl-wrapper-${pid}`).forEach(w=>{w.innerHTML=STATE.cart[pid]>0?`<div class="qty-control"><button class="btn-q" onclick="upd('${pid}',-1)">-</button><span class="val-q qty-${pid}">${STATE.cart[pid]}</span><button class="btn-q" onclick="upd('${pid}',1)" style="color:var(--c-ok)">+</button></div>`:`<button class="btn-add-big" onclick="upd('${pid}',1)">+</button>`});
    if(d>0)showToast(`+1 ${p.name.substring(0,10)}...`,'s');
}
function updateUI(){
    let c=0,sum=Object.entries(STATE.cart).reduce((a,[i,q])=>{c+=q;const p=DB_PROD.find(x=>x.id===i);return a+(p?p.price*q:0)},0);
    STATE.currentTotal=sum+(STATE.initialGap||0)-(STATE.appliedCoupon?STATE.appliedCoupon.desconto:0);
    $('chk-total-val').innerText=fmt(STATE.currentTotal);
    if($('basket-count-display'))$('basket-count-display').innerText=`${c} itens`;
    const st=$('chk-status-text');
    if(STATE.mode==='zero'){st.innerText="TOTAL";st.style.color="var(--c-s)"}
    else{
        const d=STATE.basePrice-STATE.currentTotal;
        st.innerText=d>.01?`CR√âDITO: ${fmt(d)}`:d<-.01?`ACR√âSCIMO: ${fmt(Math.abs(d))}`:"VALOR ORIGINAL";
        st.style.color=d>.01?"var(--c-ok)":d<-.01?"var(--c-err)":"var(--c-s)";
    }
}
function applyCoupon(){
    const c=DB_COUPONS.find(x=>x.codigo===$('coupon-code').value.trim().toUpperCase());
    if(!c)return showToast("Inv√°lido","r");
    if(STATE.currentTotal<c.minimo)return showToast(`M√≠nimo R$ ${c.minimo}`,"r");
    STATE.appliedCoupon=c;updateUI();
    $('coupon-msg').style.display='block';$('coupon-msg').innerText=`-${fmt(c.desconto)} aplicado!`;$('coupon-msg').style.color='var(--c-ok)';
    $('checkout-total-display').innerText=`Total: ${fmt(STATE.currentTotal)}`;showToast("Aplicado!","s");
}
function renderCatalogo(full=false){
    const q=$('search-input').value.toUpperCase(),clr=$('btn-clear-search');clr.style.display=q?'block':'none';
    const s=(a,b)=>a.name.localeCompare(b.name);
    
    // OFERTAS
    if(!q){
        const off=DB_PROD.filter(p=>p.name.toUpperCase().startsWith("**OFERTA**")).sort(s);
        $('ofertas-area').innerHTML=off.length?`<div class="carousel-container" id="cat-ofertas"><div class="section-header"><div class="section-title" style="color:var(--c-err)">üî• SUPER OFERTAS</div></div><div class="carousel-arrow arrow-left" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:-250,behavior:'smooth'})">‚ùÆ</div><div class="carousel-track">${off.map(p=>renderProdCard(p)).join('')}</div><div class="carousel-arrow arrow-right" onclick="this.parentElement.querySelector('.carousel-track').scrollBy({left:250,behavior:'smooth'})">‚ùØ</div></div>`:'';
    } else {
        $('ofertas-area').innerHTML='';
    }

    // LISTA
    if(q){
        let r=DB_PROD.filter(p=>p.name.toUpperCase().includes(q)).sort(s);
        $('catalogo-content').innerHTML=r.length?`<div class="cat-grid">${r.map(p=>renderProdCard(p)).join('')}</div>`:`<p style="text-align:center;padding:40px;color:#64748B">Nada encontrado.</p>`;
        return;
    }

    // CATEGORIAS LAZY
    const cats={};DB_PROD.forEach(p=>{if(!cats[p.category])cats[p.category]=[];cats[p.category].push(p)});
    let sc=Object.keys(cats).sort();if(sc.includes("Outros")){sc=sc.filter(c=>c!=="Outros");sc.push("Outros")}
    
    // Build Menu
    $('cat-menu').innerHTML=sc.map(c=>`<div class="custom-option" onclick="scrollToCat('cat-${c.replace(/[^a-zA-Z0-9]/g,'-')}')">${formatText(c)}</div>`).join('');

    STATE.catQueue = sc.map(c=>({name:c, prods:cats[c]}));
    STATE.catPage = 0;
    $('catalogo-content').innerHTML = "";
    loadMoreCats();
}

function loadMoreCats(){
    if(!STATE.catQueue || STATE.catQueue.length <= STATE.catPage) return;
    const next = STATE.catQueue.slice(STATE.catPage, STATE.catPage+2); // Load 2 cats at a time
    let h = "";
    next.forEach(c => {
        const id=`cat-${c.name.replace(/[^a-zA-Z0-9]/g,'-')}`;
        h += `<div id="${id}"><div class="section-header"><div class="section-title">${formatText(c.name)}</div></div><div class="cat-grid">${c.prods.map(p=>renderProdCard(p)).join('')}</div></div>`;
    });
    const d=document.createElement('div'); d.innerHTML=h;
    while(d.firstChild) $('catalogo-content').appendChild(d.firstChild);
    STATE.catPage += 2;
}

function openCategoryModal(n){
    // Deprecated by scrolling design, but keeping for compatibility if called
    scrollToCat(`cat-${n.replace(/[^a-zA-Z0-9]/g,'-')}`);
}

function renderProdCard(p){
    const q=STATE.cart[p.id]||0;
    return `<div class="prod-card"><img src="${p.img}" class="prod-img" loading="lazy" onclick="openImageZoom('${p.img}')">${p.validade?`<div class="prod-validity">Val: ${p.validade}</div>`:''}<div class="prod-name">${formatText(p.name)}</div><div class="prod-price">${fmt(p.price)}</div><div class="ctl-wrapper-${p.id}">${q>0?`<div class="qty-control"><button class="btn-q" onclick="upd('${p.id}',-1)">-</button><span class="val-q qty-${p.id}">${q}</span><button class="btn-q" onclick="upd('${p.id}',1)" style="color:var(--c-ok)">+</button></div>`:`<button class="btn-add-big" onclick="upd('${p.id}',1)">+</button>`}</div></div>`;
}
function showTopInfo(t){
    $('mini-info-title').innerText=t==='pagamento'?"Pagamento":"Entrega";
    $('mini-info-text').innerHTML=t==='pagamento'?"Aceitamos:<br>‚Ä¢ PIX<br>‚Ä¢ Dinheiro<br>‚Ä¢ Cart√µes":"Entregamos Cuiab√° e VG.<br>At√© 24h √∫teis.";
    $('modal-mini-info').showModal();
}
function showToast(m,t){
    const d=document.createElement('div');d.className='toast';d.style.background=t==='r'?'var(--c-p)':'var(--c-ok)';d.innerHTML=t==='r'?`üóëÔ∏è ${m}`:`‚úÖ ${m}`;
    $('toast-container').appendChild(d);setTimeout(()=>{d.style.opacity='0';setTimeout(()=>d.remove(),400)},2000);
}
function openDiffModal(){
    let m={},r=[],a=[];if(STATE.cesta)STATE.cesta.produtos.forEach(i=>{const p=i.split('x');if(p.length>1)m[p[1].trim()]=parseInt(p[0])});
    Object.entries(m).forEach(([id,q])=>{const c=STATE.cart[id]||0;if(c<q){const p=DB_PROD.find(x=>x.id===id);if(p)r.push(`<div><strong>- ${q-c}x</strong> ${formatText(p.name)}</div>`)}});
    Object.entries(STATE.cart).forEach(([id,q])=>{const o=m[id]||0;if(q>o){const p=DB_PROD.find(x=>x.id===id);if(p)a.push(`<div><strong>+ ${q-o}x</strong> ${formatText(p.name)}</div>`)}});
    $('diff-content').innerHTML=(!r.length&&!a.length)?"Sem altera√ß√µes.":((r.length?`<h4 style="color:var(--c-err)">Retirados:</h4>${r.join('')}`:'')+(a.length?`<h4 style="color:var(--c-ok);margin-top:10px">Adicionados:</h4>${a.join('')}`:''));
    $('modal-diff').showModal();
}
function openCheckoutModal(){
    if(STATE.mode==='custom'&&STATE.currentTotal<(STATE.basePrice-.5))return alert(`Faltam ${fmt(STATE.basePrice-STATE.currentTotal)}`);
    if(STATE.mode==='zero'){if(STATE.currentTotal<85)return alert(`M√≠nimo R$ 85,00.`);if(Object.keys(STATE.cart).length<10)return alert(`M√≠nimo 10 itens.`);}
    let tc=0;Object.values(STATE.cart).forEach(q=>tc+=q);$('checkout-subtitle').innerText=`${tc} produtos`;
    $('checkout-carousel-track').innerHTML=Object.entries(STATE.cart).map(([id,q])=>{
        const p=DB_PROD.find(x=>x.id===id);return p?`<div class="prod-card" style="width:130px;flex:0 0 130px;box-shadow:none;border:1px solid #f1f5f9"><img src="${p.img}" class="prod-img" loading="lazy"><div class="prod-name" style="height:auto;-webkit-line-clamp:2;font-size:.75rem">${formatText(p.name)}</div><div style="font-weight:700;color:var(--c-p);margin-top:5px;text-align:center;background:#f1f5f9;border-radius:8px;padding:4px">${q}x</div></div>`:''
    }).join('');
    $('checkout-total-display').innerText=`Total: ${fmt(STATE.currentTotal)}`;$('modal-checkout').showModal();
}
async function sendOrder(){
    const n=$('cust-name').value,p=$('cust-pay').value;if(!n)return alert("Digite seu nome.");
    const oid=new Date().getTime().toString().slice(-6),cl=`TIPO: ${STATE.mode==='zero'?'ZERO':'PERSONAL'} | CESTA: ${STATE.cesta?STATE.cesta.nome:'N/A'}`+(STATE.appliedCoupon?` | CUP: ${STATE.appliedCoupon.codigo}`:'');
    const its=[];Object.entries(STATE.cart).forEach(([id,q])=>{const x=DB_PROD.find(z=>z.id===id);if(x)its.push({id:x.id,nome:x.name,quantidade:q,preco_unitario:x.price})});
    try{await fetch("https://hook.eu1.make.com/yisqs4w309ogi6fx4969dbsr2q7fu7il",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cliente:{nome:n},pedido:{itens:its,total_site:STATE.currentTotal,forma_pagamento:p,cesta_origem:cl,observacoes:`Ref #${oid}`}})});}catch(e){}
    let m=`*PEDIDO #${oid}*\nüë§ ${n}\nüí∞ ${p}\n\n*ITENS:*\n`+its.map(i=>`${i.quantidade}x ${i.nome}`).join('\n')+(STATE.appliedCoupon?`\nüè∑Ô∏è Cupom: ${STATE.appliedCoupon.codigo}`:'')+`\n*TOTAL: ${fmt(STATE.currentTotal)}*`;
    window.location.href=`https://wa.me/${CONFIG_WHATSAPP}?text=${encodeURIComponent(m)}`;
}
function fmt(v){return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}
function clearSearch(){$('search-input').value="";renderCatalogo()}
function openImageZoom(s){$('zoom-img').src=s;$('modal-image-zoom').showModal()}
init();
</script>
</body>
</html>
