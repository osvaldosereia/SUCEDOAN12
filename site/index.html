<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="Super Cestas B√°sicas Dona Ant√¥nia - Qualidade e pre√ßo justo.">
<meta name="theme-color" content="#ffffff">
<title>Super Cestas B√°sicas Dona Ant√¥nia</title>
<style>
:root {
    /* PALETA PROFISSIONAL (MAIOR CONTRASTE) */
    --c-p: #0f172a;      /* Texto Principal */
    --c-s: #1e293b;      /* Texto Secund√°rio (Escurecido) */
    --c-t: #64748b;      /* Texto Terci√°rio */
    --c-a: #ea580c;      /* A√ß√£o Principal (Laranja) */
    --c-ok: #15803d;     /* Sucesso */
    --c-err: #b91c1c;    /* Erro */
    --c-bg: #e2e8f0;     /* Fundo Geral (Mais escuro para contraste) */
    --c-surf: #ffffff;   /* Superf√≠cie Cards */
    --c-bd: #cbd5e1;     /* Bordas */
    --font: 'Inter', system-ui, sans-serif;
    
    --sh-card: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Elevation */
    --sh-float: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;outline:none}
body{font-family:var(--font);background:var(--c-bg);color:var(--c-p);margin:0;padding:0;height:100dvh;display:flex;flex-direction:column;overflow:hidden;-webkit-font-smoothing:antialiased}
img{user-select:none;} 
button{cursor:pointer;border:none;background:0 0;font-family:inherit;font-weight:600}

/* LAYOUT DESKTOP LIMITER */
.layout-limit { width: 100%; max-width: 1200px; margin: 0 auto; position: relative; }

/* HEADER */
.app-header{flex:0 0 auto;width:100%;background:#fff;border-bottom:1px solid var(--c-bd);z-index:20;display:flex;justify-content:center}
.header-inner{display:flex;align-items:center;justify-content:space-between;padding:12px 20px;height:100%}
.header-brand{display:flex;align-items:center;gap:10px}
.logo{width:42px;height:42px;border-radius:50%;object-fit:cover;border:1px solid var(--c-bd)}
.brand-txt{font-size:.9rem;font-weight:800;line-height:1.1}
.btn-info-pill{background:#f1f5f9;color:var(--c-p);padding:8px 16px;border-radius:20px;font-size:0.8rem;font-weight:700;border:1px solid var(--c-bd);transition:.2s}
.btn-info-pill:hover{background:#e2e8f0;border-color:var(--c-p)}

/* PALCO CENTRAL */
.main-stage{flex:1;position:relative;display:flex;flex-direction:column;justify-content:center;overflow:hidden;background:var(--c-bg)}
.stage-limiter {width:100%;max-width:1200px;height:100%;margin:0 auto;position:relative;display:flex;align-items:center;}

.carousel-wrapper{
    width:100%; height:100%;
    display:flex; align-items:center;
    overflow-x:auto; overflow-y:hidden;
    scroll-behavior:smooth;
    padding:10px 20px; gap:15px;
    scroll-snap-type:x mandatory;
}
.carousel-wrapper::-webkit-scrollbar{display:none}

/* CARDS */
.u-card{
    flex:0 0 200px;
    scroll-snap-align:center;
    background:var(--c-surf);
    border-radius:20px;
    border:1px solid #fff;
    box-shadow:var(--sh-card);
    display:flex;flex-direction:column;
    overflow:hidden; position:relative;
    height:auto; max-height:100%;
    transition:transform .2s, box-shadow .2s;
}
.u-card:hover{box-shadow:var(--sh-float);transform:translateY(-4px);z-index:10}

@media(max-width:600px){
    .u-card{flex:0 0 70%;}
    .carousel-wrapper{padding:10px 10%;}
}

.u-img-area{width:100%;aspect-ratio:1;background:#fff;position:relative;overflow:hidden;border-bottom:1px solid #f1f5f9;cursor:zoom-in}
.u-img{width:100%;height:100%;object-fit:contain;mix-blend-mode:multiply;padding:10px;transition:transform .3s}
.u-img-area:hover .u-img{transform:scale(1.05)}
.u-img-cesta{object-fit:cover;padding:0;mix-blend-mode:normal}

/* ETIQUETAS E COMBOS */
.offer-tag{position:absolute;bottom:0;left:0;background:#dc2626;color:#fff;font-size:0.7rem;padding:4px 10px;border-top-right-radius:12px;font-weight:800;z-index:5;box-shadow:2px -2px 5px rgba(0,0,0,0.1)}
.stock-tag{position:absolute;top:8px;right:8px;background:#fff;color:var(--c-err);border:1px solid var(--c-err);padding:2px 6px;border-radius:6px;font-size:0.6rem;font-weight:800;z-index:5;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
.u-tag{position:absolute;top:8px;left:8px;background:#fff;padding:2px 6px;border-radius:6px;font-size:0.65rem;font-weight:700;box-shadow:0 2px 5px rgba(0,0,0,0.1);z-index:2}

/* Estilos Espec√≠ficos para Combos */
.combo-strike { text-decoration: line-through; color: var(--c-t); font-size: 0.85rem; font-weight: 600; }
.combo-save { color: var(--c-ok); font-size: 0.75rem; font-weight: 800; background: #dcfce7; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-top: 2px;}

.u-info{padding:12px;display:flex;flex-direction:column;gap:6px;flex:1}
.u-name{
    font-size:0.9rem; font-weight:600;
    color:var(--c-p); line-height:1.3;
    display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;
    min-height:2.6em;
}
.u-price{font-size:1.3rem;font-weight:900;color:var(--c-a);letter-spacing:-0.5px}

/* BOT√ïES E INPUTS */
.u-action-row{margin-top:auto;padding-top:8px}
.btn-big-action{
    width:100%; background:var(--c-p); color:#fff;
    padding:12px; border-radius:12px;
    font-weight:700; font-size:0.9rem;
    display:flex; align-items:center; justify-content:center; gap:4px;
    transition:background .2s, transform .1s;
}
.btn-big-action:active{transform:scale(0.95)}
.btn-big-action.success-flash{animation:flashGreen 0.5s ease-out}

@keyframes flashGreen {
    0% { background: var(--c-p); }
    50% { background: var(--c-ok); transform: scale(1.05); }
    100% { background: var(--c-p); }
}

.qty-row{display:flex;align-items:center;justify-content:space-between;background:#f1f5f9;border-radius:12px;padding:4px;border:1px solid var(--c-bd)}
.btn-qty{width:36px;height:36px;border-radius:8px;background:#fff;font-size:1.2rem;font-weight:800;box-shadow:var(--sh-sm);color:var(--c-p)}
.qty-inp{
    width:50px; text-align:center; font-size:1.1rem; font-weight:800;
    border:none; background:transparent; color:var(--c-p);
    -moz-appearance:textfield;
}
.qty-inp::-webkit-outer-spin-button,.qty-inp::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}

/* SETAS */
.nav-arrow{
    position:absolute;top:50%;transform:translateY(-50%);
    width:48px;height:48px;border-radius:50%;
    background:#fff;border:1px solid var(--c-bd);
    box-shadow:var(--sh-float);z-index:20;cursor:pointer;
    display:none;align-items:center;justify-content:center;
    font-size:1.2rem;color:var(--c-p);
    transition:transform .2s;
}
.nav-arrow:hover{background:var(--c-p);color:#fff;transform:translateY(-50%) scale(1.1)}
.nav-left{left:-20px} .nav-right{right:-20px}
@media(min-width:1300px){ .nav-left{left:-60px} .nav-right{right:-60px} }
@media(min-width:1024px){.nav-arrow{display:flex}}

/* BOTTOM STACK */
.bottom-stack{
    flex:0 0 auto; background:#fff;
    border-top:1px solid var(--c-bd);
    box-shadow:0 -5px 25px rgba(0,0,0,0.05);
    z-index:30; display:flex; flex-direction:column; align-items:center;
}
.stack-inner { width: 100%; max-width: 1200px; }

/* PROGRESS BAR */
.progress-area{width:100%;background:#f1f5f9;padding:8px 20px;border-bottom:1px solid #e2e8f0;display:flex;flex-direction:column;align-items:center;gap:4px}
.prog-txt{font-size:0.75rem;font-weight:700;color:var(--c-s);text-transform:uppercase;text-align:center}
.prog-track{width:100%;height:6px;background:#cbd5e1;border-radius:3px;overflow:hidden}
.prog-fill{height:100%;background:var(--c-a);width:0%;transition:width .5s ease-out}

/* MENU & FILTERS */
.menu-area-wrapper{display:flex;flex-direction:column;gap:15px;padding:15px 20px 10px;border-bottom:1px solid #f1f5f9}

.menu-scroll-area{
    width:100%; overflow-x:auto; display:flex; gap:12px; align-items: flex-start;
}
.menu-scroll-area::-webkit-scrollbar{display:none}

.cat-bubble{display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer;min-width:75px;opacity:1;transition:.3s}
.cat-bubble.active{transform:scale(1.05)}
.cat-bubble.active .cat-img-ring{border-color:var(--c-a);box-shadow:0 0 0 3px rgba(234,88,12,0.2)}
.cat-bubble.active .cat-name{color:var(--c-a);font-weight:800}

.cat-img-ring{width:72px;height:72px;border-radius:50%;padding:2px;border:2px solid var(--c-bd);background:#fff;display:flex;align-items:center;justify-content:center;transition:border-color .2s}
.cat-img{width:100%;height:100%;border-radius:50%;object-fit:cover;background:#f1f5f9}
.cat-name{font-size:0.75rem;font-weight:600;color:var(--c-s);text-align:center;line-height:1.1;max-width:85px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.cat-bubble[id*="__CART__"] .cat-img-ring { background: var(--c-p); border-color: var(--c-p); color:#fff; }

/* SEARCH & FILTER ROW */
.search-filter-row{display:flex;gap:10px;padding:0 20px 10px;background:#fff}
.search-bar-area{flex:1;position:relative}
.search-inp{width:100%;background:#f8fafc;border:1px solid var(--c-bd);padding:10px 12px 10px 40px;border-radius:10px;font-weight:600;color:var(--c-p);transition:box-shadow .2s}
.search-inp:focus{box-shadow:0 0 0 2px rgba(15, 23, 42, 0.1); border-color:var(--c-p)}
.search-icon{position:absolute;left:32px;top:50%;transform:translateY(-50%);color:var(--c-t);pointer-events:none;left:12px}
.clear-search{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:#cbd5e1;color:#fff;border-radius:50%;width:20px;height:20px;font-size:12px;display:none;align-items:center;justify-content:center;cursor:pointer}

.filter-sel{background:#f8fafc;border:1px solid var(--c-bd);border-radius:10px;padding:0 10px;font-weight:600;color:var(--c-s);font-size:0.85rem}

/* CHECKOUT */
.checkout-bar{padding:15px 20px 20px;display:flex;align-items:center;justify-content:space-between;gap:15px}
.total-info{display:flex;flex-direction:column}
.lbl-total{font-size:0.7rem;text-transform:uppercase;font-weight:800;color:var(--c-s)}
.val-total{font-size:1.4rem;font-weight:900;color:var(--c-p)}
.btn-checkout{flex:1;background:#16a34a;color:#fff;padding:14px;border-radius:12px;font-weight:800;font-size:1rem;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 4px 12px rgba(22,163,74,0.3);transition:transform .1s}
.btn-checkout:active{transform:scale(0.98)}
.btn-checkout:disabled{background:#94a3b8;cursor:not-allowed;box-shadow:none}

/* MODAIS */
dialog{border:none;border-radius:24px;width:92%;max-width:420px;padding:0;box-shadow:0 25px 50px -12px rgba(0,0,0,0.4);background:#fff;animation:modalPop .3s}
dialog::backdrop{background:rgba(15,23,42,0.85);backdrop-filter:blur(4px)}
@keyframes modalPop{from{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}
.modal-body{padding:25px 20px;text-align:center}
.btn-modal{width:100%;padding:14px;border-radius:12px;font-weight:800;margin-bottom:10px;font-size:1rem}
.btn-modal.primary{background:var(--c-p);color:#fff}
.btn-modal.secondary{background:#fff;border:2px solid var(--c-bd);color:var(--c-s)}

/* WELCOME MODAL */
#modal-welcome { width: 100%; height: 100%; max-width: none; max-height: none; background: transparent; box-shadow: none; }
#modal-welcome::backdrop { background: rgba(15,23,42,0.95); }
.welcome-container {
    height: 100%; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;
}
.welcome-title { font-size: 1.8rem; font-weight: 900; color: #fff; margin-bottom: 30px; text-align: center; }
.btn-welcome {
    width: 100%; max-width: 340px;
    background: #fff; color: var(--c-p);
    padding: 20px; margin-bottom: 15px;
    border-radius: 20px;
    display: flex; flex-direction: column; align-items: center; gap: 5px;
    cursor: pointer; transition: transform 0.2s;
}
.btn-welcome:hover { transform: scale(1.02); }
.btn-welcome:active { transform: scale(0.98); }
.btn-welcome h3 { margin: 0; font-size: 1.1rem; font-weight: 800; text-transform: uppercase; color: var(--c-p); }
.btn-welcome p { margin: 0; font-size: 0.9rem; color: var(--c-s); }

/* ZOOM */
#modal-image-zoom{background:transparent;box-shadow:none;width:100%;height:100%;max-width:none;max-height:none}
#modal-image-zoom .modal-body{padding:0;display:flex;align-items:center;justify-content:center;height:100vh;width:100vw;position:relative}
#zoom-img{max-width:90%;max-height:85vh;border-radius:12px;background:#fff;box-shadow:0 25px 50px rgba(0,0,0,0.5)}
.btn-close-zoom{position:absolute;top:20px;right:20px;width:44px;height:44px;background:#fff;border-radius:50%;color:var(--c-p);font-weight:800;font-size:1.2rem;box-shadow:0 4px 12px rgba(0,0,0,0.3);z-index:2010;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .2s}
.btn-close-zoom:hover{transform:scale(1.1)}

/* FAQ & SOCIAL */
.faq-header { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-bottom: 20px; border-bottom:1px solid #eee; padding-bottom:15px }
.faq-logo { width: 80px; height: 80px; border-radius: 50%; border:1px solid #cbd5e1; }
.faq-info-txt { font-size: 0.85rem; color: var(--c-s); line-height: 1.4; }
.faq-item { text-align: left; margin-bottom: 12px; border-bottom: 1px dashed #f1f5f9; padding-bottom: 8px; }
.faq-q { font-weight: 700; color: var(--c-p); font-size: 0.9rem; }
.faq-a { font-size: 0.8rem; color: var(--c-s); margin-top: 4px; }
.social-row { display: flex; gap: 10px; justify-content: center; margin-top: 20px; margin-bottom: 15px; }
.btn-social { flex: 1; padding: 10px; border-radius: 10px; font-weight: 700; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 6px; color: #fff; }

/* MODAL CAROUSEL */
.modal-carousel-track { display: flex; overflow-x: auto; gap: 12px; padding: 10px 5px; scroll-snap-type: x mandatory; justify-content: flex-start; }
.modal-carousel-track::-webkit-scrollbar{height:4px;background:transparent}
.modal-card { flex: 0 0 140px; scroll-snap-align: start; border: 1px solid #eee; border-radius: 12px; padding: 8px; background: #fff; display: flex; flex-direction: column; text-align: left; }
.modal-card img { width: 100%; aspect-ratio: 1; object-fit: contain; mix-blend-mode: multiply; margin-bottom: 6px; }
.modal-card .mc-name { font-size: 0.75rem; font-weight: 700; color: var(--c-p); margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 2.5em; }
.modal-card .mc-price { font-size: 0.9rem; font-weight: 800; color: var(--c-a); margin-top: auto; }
.modal-card .mc-qty { font-size: 0.75rem; font-weight: 600; color: var(--c-s); background: #f1f5f9; padding: 2px 6px; border-radius: 4px; width: fit-content; margin-top: 4px; }

</style>
</head>
<body>

<header class="app-header">
    <div class="layout-limit header-inner">
        <div class="header-brand">
            <img src="img/produtos/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" class="logo" alt="Logo">
            <div class="brand-txt">Super Cestas<br>Dona Ant√¥nia</div>
        </div>
        <div class="header-actions">
            <button class="btn-info-pill" onclick="$('modal-faq').showModal()">INFORMA√á√ïES</button>
        </div>
    </div>
</header>

<main class="main-stage">
    <div class="stage-limiter">
        <div class="nav-arrow nav-left" onclick="$('main-carousel').scrollBy({left:-300,behavior:'smooth'})">‚ùÆ</div>
        <div class="carousel-wrapper" id="main-carousel">
            </div>
        <div class="nav-arrow nav-right" onclick="$('main-carousel').scrollBy({left:300,behavior:'smooth'})">‚ùØ</div>
    </div>
</main>

<div class="bottom-stack">
    <div class="stack-inner">
        <div class="progress-area" id="progress-area">
            <div class="prog-txt" id="prog-txt">Faltam R$ 85,00 para fechar pedido</div>
            <div class="prog-track"><div class="prog-fill" id="prog-fill"></div></div>
        </div>

        <div class="menu-area-wrapper">
            <div class="menu-scroll-area" id="menu-bubbles"></div>
        </div>

        <div class="search-filter-row">
            <div class="search-bar-area">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input type="text" id="search-inp" class="search-inp" placeholder="Buscar..." oninput="handleSearch(this.value)">
                <button class="clear-search" id="btn-clr-search" onclick="clearSearch()">‚úï</button>
            </div>
            <select class="filter-sel" id="filter-sel" onchange="applyFilter()">
                <option value="def">Padr√£o</option>
                <option value="min">Menor Pre√ßo</option>
                <option value="max">Maior Pre√ßo</option>
                <option value="az">A-Z</option>
            </select>
        </div>

        <div class="checkout-bar">
            <div class="total-info">
                <span class="lbl-total">Total</span>
                <span class="val-total" id="val-total">R$ 0,00</span>
            </div>
            <button class="btn-checkout" id="btn-checkout" onclick="openCheckout()" disabled>
                VER CARRINHO <span id="badge-count" style="background:rgba(255,255,255,0.2);padding:2px 8px;border-radius:10px;font-size:0.8rem">0</span>
            </button>
        </div>
    </div>
</div>

<div id="toast-container"></div>

<dialog id="modal-welcome">
    <div class="welcome-container">
        <h2 class="welcome-title">Ol√°! Como voc√™ quer fazer suas compras hoje?</h2>
        
        <button class="btn-welcome" onclick="closeWelcome('__CESTAS__')">
            <h3 style="color:#ea580c">Ver as Cestas</h3>
            <p>J√° vem montada, pr√°tico e r√°pido.</p>
        </button>
        
        <button class="btn-welcome" onclick="closeWelcome('__OFFERS__')">
            <h3 style="color:#0f172a">Montar Minha Cesta</h3>
            <p>Vou escolher item por item.</p>
        </button>
    </div>
</dialog>

<dialog id="modal-basket-preview">
    <div class="modal-body">
        <h3 class="stage-title" style="color:var(--c-p);font-size:1.4rem" id="prev-title"></h3>
        <p style="color:var(--c-s);margin-bottom:15px" id="prev-desc"></p>
        <div style="background:#f8fafc;padding:5px;border-radius:12px;border:1px solid var(--c-bd);margin-bottom:15px">
            <div class="modal-carousel-track" id="prev-list"></div>
        </div>
        <div style="margin-top:20px">
            <div style="font-size:1.8rem;font-weight:900;color:var(--c-a);margin-bottom:15px" id="prev-price"></div>
            <button class="btn-modal primary" id="btn-confirm-preview">QUERO ESTA CESTA</button>
            <button class="btn-modal secondary" onclick="$('modal-basket-preview').close()">Voltar</button>
        </div>
    </div>
</dialog>

<dialog id="modal-checkout">
    <div class="modal-body" style="text-align:left">
        <h3 style="text-align:center;text-transform:uppercase;font-weight:900">Finalizar Pedido</h3>
        <div style="background:#f8fafc;padding:5px;border-radius:12px;border:1px solid var(--c-bd);margin:15px 0">
            <div class="modal-carousel-track" id="chk-list"></div>
        </div>
        <div style="text-align:right;margin-bottom:15px">
            <div style="font-size:1.4rem;font-weight:900" id="chk-total"></div>
        </div>
        <label style="font-size:.75rem;font-weight:800;color:var(--c-s)">CUPOM:</label>
        <div style="display:flex;gap:5px;margin-bottom:15px">
            <input id="cupom-code" style="flex:1;padding:10px;border:1px solid var(--c-bd);border-radius:8px;text-transform:uppercase" placeholder="C√ìDIGO">
            <button onclick="applyCupom()" style="background:var(--c-p);color:#fff;padding:0 15px;border-radius:8px;font-weight:700">OK</button>
        </div>
        <div id="cupom-msg" style="font-size:.8rem;font-weight:700;margin-bottom:10px;display:none"></div>
        <input id="cli-nome" style="width:100%;padding:12px;margin-bottom:10px;border:1px solid var(--c-bd);border-radius:8px;font-weight:600" placeholder="Seu Nome Completo">
        <select id="cli-pgto" style="width:100%;padding:12px;margin-bottom:20px;border:1px solid var(--c-bd);border-radius:8px;font-weight:600;background:#fff">
            <option>PIX na Entrega</option>
            <option>Dinheiro</option>
            <option>Cart√£o de Cr√©dito</option>
            <option>Cart√£o de D√©bito</option>
            <option>Cart√£o Alimenta√ß√£o</option>
        </select>
        <button class="btn-modal primary" onclick="sendOrder()">ENVIAR PEDIDO (WHATSAPP)</button>
        <button class="btn-modal secondary" onclick="$('modal-checkout').close()">Continuar Comprando</button>
        <button class="btn-modal" style="color:var(--c-err);font-size:0.8rem" onclick="clearCart()">Esvaziar Carrinho</button>
    </div>
</dialog>

<dialog id="modal-image-zoom" onclick="if(event.target===this)this.close()">
    <div class="modal-body">
        <button class="btn-close-zoom" onclick="this.closest('dialog').close()">‚úï</button>
        <img id="zoom-img" src="">
    </div>
</dialog>

<dialog id="modal-faq" onclick="if(event.target===this)this.close()">
    <div class="modal-body">
        <div class="faq-header">
            <img src="img/produtos/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" class="faq-logo" alt="Logo">
            <h3 style="font-weight:900;color:var(--c-p);text-transform:uppercase">Dona Ant√¥nia</h3>
            <div class="faq-info-txt">Cuiab√° e V√°rzea Grande - MT<br>Tel: (65) 99681-3588</div>
        </div>
        <div class="faq-item"><div class="faq-q">Qual o valor da entrega?</div><div class="faq-a">A entrega √© totalmente gr√°tis para Cuiab√° e V√°rzea Grande.</div></div>
        <div class="faq-item"><div class="faq-q">Quais as formas de pagamento?</div><div class="faq-a">Aceitamos PIX, Dinheiro, Cart√£o de Cr√©dito e D√©bito na entrega.</div></div>
        <div class="faq-item"><div class="faq-q">Qual o prazo de entrega?</div><div class="faq-a">Entregas em at√© 24 horas √∫teis ap√≥s a confirma√ß√£o do pedido.</div></div>
        <div class="faq-item"><div class="faq-q">Posso personalizar a cesta?</div><div class="faq-a">Sim! Voc√™ pode adicionar ou remover itens conforme sua necessidade.</div></div>
        <div class="social-row">
            <button class="btn-social" style="background:#25D366" onclick="window.open('https://wa.me/5565996813588','_blank')">WhatsApp</button>
            <button class="btn-social" style="background:#E1306C" onclick="alert('Link do Instagram aqui')">Instagram</button>
        </div>
        <button class="btn-modal secondary" onclick="this.closest('dialog').close()">Voltar</button>
    </div>
</dialog>

<script>
const $=i=>document.getElementById(i);
const STATE={
    baskets:[], prods:[], coupons:[], combos:[],
    cart:{}, cartOrder:[], 
    activeCat:'__CESTAS__', 
    mode:'zero', 
    baseBasket:null, minBasketPrice:0, 
    basketExtraFee:0, 
    comboDiscount: 0, // Desconto din√¢mico calculado
    coupon:null,
    currentList: []
};

async function init(){
    try{
        const[r1,r2,r3,r4]=await Promise.all([
            fetch('produtos-cesta-basica.json?v='+Date.now()),
            fetch('produtos.json?v='+Date.now()),
            fetch('cupons.json?v='+Date.now()).catch(()=>({ok:false})),
            fetch('combos.json?v='+Date.now()).catch(()=>({ok:false}))
        ]);
        if(r1.ok) STATE.baskets = await r1.json();
        if(r2.ok){
            let t=(await r2.text()).trim().replace(/,(\s+)?$/,"");
            let raw = JSON.parse(t.startsWith('[')?t:'['+t+']');
            STATE.prods = raw.filter(x=>x.situacao==="A").map(p=>({
                id:String(p.id), code:String(p.codigo||p.id),
                name:p.nome, price:parseFloat(p.preco),
                stock:parseInt(p.estoque)||0,
                cat:(p.categoria||p.Categoria||"Outros").trim(),
                val:p.validade, img:`img/produtos/${p.codigo||p.id}.webp`
            }));
        }
        if(r3&&r3.ok) STATE.coupons = await r3.json();
        if(r4&&r4.ok) STATE.combos = await r4.json();

        renderMenu();
        $('modal-welcome').showModal();
        updateTotals(); 
    }catch(e){$('main-carousel').innerHTML='<p style="padding:20px;text-align:center">Erro ao carregar dados.</p>';console.error(e)}
}

function closeWelcome(targetCat){
    $('modal-welcome').close();
    loadCategory(targetCat);
}

/* --- LOGIC MENU --- */
function renderMenu(){
    const cats = {};
    STATE.prods.forEach(p=>{ if(!cats[p.cat])cats[p.cat]=[]; cats[p.cat].push(p) });
    let catKeys = Object.keys(cats).sort();
    
    const offers = STATE.prods.filter(p=>p.name.includes("**"));
    const under5 = STATE.prods.filter(p=>p.price <= 5.00);
    const under10 = STATE.prods.filter(p=>p.price > 5.00 && p.price <= 10.00);

    const menuItems = [
        {key:'__CART__', name:'Minha Cesta', img:null}, 
        {key:'__CESTAS__', name:'Cestas B√°sicas', img:'img/produtos/cesta.webp'}
    ];

    if(STATE.combos && STATE.combos.length > 0) {
        menuItems.push({key:'__COMBOS__', name:'üéÅ Combos', img:STATE.combos[0].imagem || 'img/produtos/cesta.webp'});
    }

    if(offers.length) menuItems.push({key:'__OFFERS__', name:'üî• Ofertas', img:offers[0].img});
    if(under5.length) menuItems.push({key:'__UNDER_5__', name:'üü¢ At√© R$ 5,00', img:under5[0].img});
    if(under10.length) menuItems.push({key:'__UNDER_10__', name:'üîµ At√© R$ 10,00', img:under10[0].img});

    catKeys.forEach(k=>{
        menuItems.push({key:k, name:k, img:cats[k][0]?.img});
    });

    $('menu-bubbles').innerHTML = menuItems.map(m=>{
        const idKey = m.key.replace(/\s/g,'-');
        let content;
        if(m.key === '__CART__'){
            content = `<div class="cat-img-ring"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg></div>`;
        } else {
            const img = m.img || 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23cbd5e1"><circle cx="12" cy="12" r="10"/></svg>';
            content = `<div class="cat-img-ring"><img src="${img}" class="cat-img" onerror="this.src='data:image/svg+xml,<svg...'"></div>`;
        }
        return `<div class="cat-bubble ${STATE.activeCat===m.key?'active':''}" onclick="loadCategory('${m.key.replace(/'/g,"\\'")}')" id="bubble-${idKey}">${content}<div class="cat-name">${formatName(m.name)}</div></div>`
    }).join('');
}

function loadCategory(key){
    if(key === '__CART__' && Object.keys(STATE.cart).length === 0) return showToast("Seu carrinho est√° vazio!", "r");

    document.querySelectorAll('.cat-bubble').forEach(el=>el.classList.remove('active'));
    const bub = document.getElementById(`bubble-${key.replace(/\s/g,'-')}`);
    if(bub) bub.classList.add('active');

    STATE.activeCat = key;
    
    if(key === '__CESTAS__'){
        STATE.currentList = STATE.baskets;
        renderChunked(STATE.currentList, 'BASKET', true);
    } 
    else if(key === '__COMBOS__'){
        STATE.currentList = STATE.combos;
        renderChunked(STATE.currentList, 'COMBO', true);
    }
    else if(key === '__CART__'){
        STATE.currentList = STATE.cartOrder.map(id=>STATE.prods.find(p=>p.id===id)).filter(Boolean);
        renderChunked(STATE.currentList, 'PROD', true);
    }
    else if(key === '__OFFERS__'){
        STATE.currentList = STATE.prods.filter(p=>p.name.includes("**"));
        applyFilter(); 
    }
    else if(key === '__UNDER_5__'){
        STATE.currentList = STATE.prods.filter(p=>p.price <= 5.00);
        applyFilter(); 
    }
    else if(key === '__UNDER_10__'){
        STATE.currentList = STATE.prods.filter(p=>p.price > 5.00 && p.price <= 10.00);
        applyFilter(); 
    }
    else {
        STATE.currentList = STATE.prods.filter(p=> p.cat === key);
        applyFilter(); 
    }
}

function applyFilter(){
    const type = $('filter-sel').value;
    if(STATE.activeCat === '__CESTAS__' || STATE.activeCat === '__COMBOS__') return; 
    
    let list = [...STATE.currentList];
    if(type === 'min') list.sort((a,b)=>a.price - b.price);
    if(type === 'max') list.sort((a,b)=>b.price - a.price);
    if(type === 'az') list.sort((a,b)=>a.name.localeCompare(b.name));
    
    if(type === 'def') list.sort((a,b)=>{
        const fa=a.name.includes('**'), fb=b.name.includes('**');
        return fa===fb ? 0 : fa ? -1 : 1;
    });

    renderChunked(list, 'PROD', true);
}

function renderChunked(list, type, reset){
    const carousel = $('main-carousel');
    if(reset) carousel.innerHTML = '';
    
    const html = list.map(item => {
        if(type === 'BASKET') return cardBasket(item);
        if(type === 'COMBO') return cardCombo(item);
        return cardProd(item);
    }).join('');
    
    carousel.innerHTML = html || '<p style="margin:auto;color:#94a3b8">Nenhum item encontrado.</p>';
    if(reset) carousel.scrollTo({left:0});
}

/* CARDS */
function cardBasket(item){
    return `
    <div class="u-card">
        <div class="u-img-area"><img src="${item.imagem}" class="u-img u-img-cesta" loading="lazy"></div>
        <div class="u-info">
            <div class="u-name">${formatName(item.nome)}</div>
            <div class="u-price">${fmt(item.preco)}</div>
            <div class="u-action-row">
                <button class="btn-big-action" onclick="previewBasket('${item.id}')">VER ITENS</button>
            </div>
        </div>
    </div>`;
}

function cardCombo(item){
    let sum = 0;
    item.produtos.forEach(s => {
        const [qStr, ref] = s.split('x');
        const p = STATE.prods.find(x => x.id === ref.trim() || x.code === ref.trim());
        if (p) sum += p.price * parseInt(qStr);
    });
    const econ = sum - item.preco;
    
    return `
    <div class="u-card">
        <div class="u-img-area">
            <img src="${item.imagem || 'img/produtos/cesta.webp'}" class="u-img u-img-cesta" loading="lazy">
            <div class="offer-tag" style="background:var(--c-ok)">üî• COMBO</div>
        </div>
        <div class="u-info">
            <div class="u-name">${formatName(item.nome)}</div>
            <div style="margin-top:auto">
                <div class="combo-strike">De: ${fmt(sum)}</div>
                <div class="u-price">Por: ${fmt(item.preco)}</div>
                ${econ > 0 ? `<div class="combo-save">Sua economia: ${fmt(econ)}</div>` : ''}
            </div>
            <div class="u-action-row">
                <button class="btn-big-action" onclick="previewCombo('${item.id}')">VER ITENS</button>
            </div>
        </div>
    </div>`;
}

function cardProd(item){
    const q = STATE.cart[item.id] || 0;
    const isOffer = item.name.includes("**");
    const stockWarn = item.stock < 10 ? `<div class="stock-tag">Restam ${item.stock}</div>` : '';
    
    const btn = q > 0 
        ? `<div class="qty-row">
             <button class="btn-qty" onclick="upd('${item.id}',-1)">-</button>
             <input class="qty-inp qty-${item.id}" type="number" value="${q}" onchange="upd('${item.id}',this.value- ${q})">
             <button class="btn-qty" onclick="upd('${item.id}',1)" style="color:var(--c-ok)">+</button>
           </div>`
        : `<button class="btn-big-action ${item.stock<=0?'disabled':''}" id="btn-add-${item.id}" onclick="addAnim('${item.id}');upd('${item.id}',1)" ${item.stock<=0?'disabled':''}>${item.stock<=0?'ESGOTADO':'ADICIONAR'}</button>`;
    
    return `
    <div class="u-card">
        <div class="u-img-area" onclick="openImageZoom('${item.img}')">
            <img src="${item.img}" class="u-img" loading="lazy">
            ${item.val ? `<div class="u-tag">Val: ${item.val}</div>` : ''}
            ${isOffer ? '<div class="offer-tag">OFERTA</div>' : ''}
            ${stockWarn}
        </div>
        <div class="u-info">
            <div class="u-name">${formatName(item.name)}</div>
            <div class="u-price">${fmt(item.price)}</div>
            <div class="u-action-row ctrl-wrap-${item.id}">
                ${btn}
            </div>
        </div>
    </div>`;
}

function addAnim(id){
    if(navigator.vibrate) navigator.vibrate(50);
    const btn = document.getElementById(`btn-add-${id}`);
    if(btn){
        btn.classList.add('success-flash');
        const old = btn.innerText; btn.innerText = "SUCESSO!";
        setTimeout(()=>btn.innerText=old, 600);
    }
}

/* PREVIEWS (Cesta e Combo) */
function previewBasket(id){
    const c = STATE.baskets.find(x=>String(x.id)===String(id));
    if(!c) return;
    STATE.tempBasket = c;
    $('prev-title').innerHTML = formatName(c.nome);
    $('prev-desc').innerHTML = `${c.produtos.length} itens inclusos`;
    $('prev-price').innerHTML = fmt(c.preco);
    $('prev-list').innerHTML = c.produtos.map(s=>{
        const [qtd, ref] = s.split('x');
        const p = STATE.prods.find(x=>x.id===ref.trim()||x.code===ref.trim());
        return `<div class="modal-card"><img src="${p?.img}" loading="lazy"><div class="mc-name">${p?formatName(p.name):ref}</div><div class="mc-qty">${qtd}x</div></div>`
    }).join('');
    
    const btn = $('btn-confirm-preview');
    btn.innerText = "QUERO ESTA CESTA";
    btn.onclick = () => confirmBasket();
    
    $('modal-
