<!DOCTYPE html>
<html lang="pt-BR" dir="ltr">
<head>
    <!-- 
        ================================================================
        ARCHITECT: SEO Code Architect (SCA)
        VERSION: 7.1 - App Bar Integration & Wide Sidebar
        CHANGELOG:
        - MOBILE: Implementada barra de navega√ß√£o inferior (App Bar).
        - MOBILE: Bot√µes flutuantes removidos em favor da App Bar.
        - MOBILE: Nova aba "Ofertas" com grid de 2 colunas.
        - DESKTOP: Sidebar expandida para 360px (+40% a +60%).
        - DESKTOP: Grid de produtos travado em 4 colunas.
        - DESKTOP: Bot√µes de navega√ß√£o lateral (Cats/Tags) unificados em grid de 3 colunas.
        ================================================================
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Master Tags -->
    <title>Cestas B√°sicas em Cuiab√° e V√°rzea Grande | Dona Ant√¥nia | Entrega Gr√°tis</title>
    <meta name="description" content="Compre Cesta B√°sica em Cuiab√° e V√°rzea Grande com entrega gr√°tis*. Personalize sua cesta com Arroz Tio Alvino e Feij√£o Novo. Pagamento na entrega. Pe√ßa j√°!">
    <meta name="keywords" content="cesta b√°sica cuiab√°, cesta b√°sica v√°rzea grande, entrega de alimentos cpa, atacado alimentos mt, arroz tio alvino, sacol√£o cuiab√°, supermercado delivery">
    <meta name="author" content="Dona Ant√¥nia Alimentos">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="https://www.donaantonia.com.br">
    <meta name="theme-color" content="#dc2626">
    <meta name="format-detection" content="telephone=no">

    <!-- Geo & Local SEO Signals -->
    <meta name="geo.region" content="BR-MT" />
    <meta name="geo.placename" content="Cuiab√°" />
    <meta name="geo.position" content="-15.6025;-56.0968" />
    <meta name="ICBM" content="-15.6025, -56.0968" />

    <!-- Open Graph (Social SEO) -->
    <meta property="og:locale" content="pt_BR" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Cestas B√°sicas Dona Ant√¥nia | Monte a Sua e Receba em Casa" />
    <meta property="og:description" content="Economize na compra do m√™s. Cestas completas a partir de R$ 85,00 com entrega em Cuiab√° e VG. Personalize os itens pelo site!" />
    <meta property="og:url" content="https://www.donaantonia.com.br" />
    <meta property="og:site_name" content="Dona Ant√¥nia Alimentos" />
    <meta property="og:image" content="https://donaantonia.com.br/img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Cestas B√°sicas Dona Ant√¥nia" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Cestas B√°sicas com Entrega em Cuiab√° e VG">
    <meta name="twitter:description" content="Monte sua cesta b√°sica online. Qualidade e pre√ßo baixo na Dona Ant√¥nia.">
    
    <link rel="icon" href="img/favicon.ico" sizes="any">
    
    <!-- PERFORMANCE FIX: Preload Critical Assets -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- FIX LCP CHAIN: Baixar o JSON junto com o HTML -->
    <link rel="preload" href="produtos/produtos.json" as="fetch" crossorigin="anonymous">

    <!-- ADVANCED SCHEMA.ORG JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "GroceryStore",
          "@id": "https://www.donaantonia.com.br/#store",
          "name": "Dona Ant√¥nia - Super Cestas B√°sicas",
          "image": "https://donaantonia.com.br/img/logo-super-cesta-basica-dona-antonia-cuiaba-varzea-grande.avif",
          "telephone": "+5565996813588",
          "url": "https://www.donaantonia.com.br",
          "priceRange": "$$",
          "paymentAccepted": "Cash, Credit Card, Debit Card, Pix, Meal Vouchers",
          "currenciesAccepted": "BRL",
          "address": {
            "@type": "PostalAddress",
            "streetAddress": "R. Trinta, 105 - Jardim Nossa Sra. Aparecida",
            "addressLocality": "Cuiab√°",
            "addressRegion": "MT",
            "postalCode": "78090-660",
            "addressCountry": "BR"
          },
          "geo": { "@type": "GeoCoordinates", "latitude": -15.6025, "longitude": -56.0968 },
          "openingHoursSpecification": [
            { "@type": "OpeningHoursSpecification", "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"], "opens": "07:30", "closes": "18:00" },
            { "@type": "OpeningHoursSpecification", "dayOfWeek": "Saturday", "opens": "07:30", "closes": "14:00" }
          ],
          "areaServed": [ 
            { "@type": "City", "name": "Cuiab√°" }, 
            { "@type": "City", "name": "V√°rzea Grande" }
          ],
          "potentialAction": {
            "@type": "OrderAction",
            "target": {
              "@type": "EntryPoint",
              "urlTemplate": "https://api.whatsapp.com/send?phone=5565996813588",
              "inLanguage": "pt-BR",
              "actionPlatform": ["http://schema.org/MobileWebPlatform"]
            },
            "deliveryMethod": "http://purl.org/goodrelations/v1#DeliveryModeOwnFleet"
          }
        },
        {
          "@type": "FAQPage",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "Quais s√£o as formas de pagamento aceitas?",
              "acceptedAnswer": { "@type": "Answer", "text": "Aceitamos Dinheiro, Pix, Cart√£o de D√©bito, Cart√£o de Cr√©dito (at√© 3x sem juros) e cart√µes alimenta√ß√£o/refei√ß√£o (Pluxee, Alelo, Flash, Caju, iFood)." }
            },
            {
              "@type": "Question",
              "name": "A Dona Ant√¥nia entrega em V√°rzea Grande?",
              "acceptedAnswer": { "@type": "Answer", "text": "Sim, realizamos entregas em toda a regi√£o de V√°rzea Grande e Cuiab√°, incluindo bairros como CPA, Coxip√≥, Cristo Rei e Pedra 90." }
            },
             {
              "@type": "Question",
              "name": "Qual o valor para entrega gr√°tis?",
              "acceptedAnswer": { "@type": "Answer", "text": "O frete √© gr√°tis para pedidos acima de R$ 85,00 em nossa √°rea de cobertura." }
            }
          ]
        }
      ]
    }
    </script>
    
    <style>
        /* --- 1. CORE & RESET (Optimized) --- */
        :root { 
            --primary: #dc2626; 
            --primary-dark: #b91c1c; 
            --secondary: #334155; 
            --bg: #ffffff; 
            --surface: #ffffff; 
            --text-main: #334155; 
            --text-muted: #64748b; 
            --border: #e2e8f0; 
            --header-h: 60px;
            --app-bar-h: 60px; /* Mobile App Bar Height */
            --radius: 12px; 
            --offer-color: #b45309;
            --focus-ring: #dc2626;
            --shadow-sm: none; 
            --shadow-md: none; 
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
            background-color: var(--bg); 
            color: var(--text-main); 
            line-height: 1.6; 
            padding-bottom: var(--app-bar-h); /* Space for mobile bottom bar */
            font-weight: 300; 
            font-size: 16px; 
            -webkit-font-smoothing: antialiased; 
            text-rendering: optimizeLegibility;
        }
        
        /* MOBILE PADDING REDUCED: 8px */
        .container { max-width: 1280px; margin: 0 auto; padding: 0 8px; width: 100%; }
        
        .hidden { display: none !important; }
        .visually-hidden { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
        
        button { cursor: pointer; border: none; font-family: inherit; background: none; }
        button:focus-visible, a:focus-visible, input:focus-visible, summary:focus-visible { outline: 2px solid var(--focus-ring); outline-offset: 2px; }
        img { display: block; max-width: 100%; height: auto; }

        /* --- 2. HEADER --- */
        header { 
            position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h); 
            background: rgba(255,255,255,0.95); border-bottom: 1px solid var(--border); z-index: 100; 
            display: flex; align-items: center; backdrop-filter: blur(12px);
            transition: transform 0.3s ease;
            will-change: transform;
        }
        body.header-hidden header { transform: translateY(-100%); }

        .header-inner { display: flex; justify-content: space-between; align-items: center; width: 100%; }
        
        .logo { display: flex; align-items: center; gap: 10px; font-weight: 600; font-size: 1.25rem; color: var(--secondary); text-decoration: none; letter-spacing: -0.02em; }
        .logo-div { width: 38px; height: 38px; background: #f1f5f9; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--secondary); font-weight: 700; font-size: 0.9rem; border: 1px solid #cbd5e1; }
        
        .location-badge { 
            font-size: 0.8rem; font-weight: 500; color: var(--secondary); 
            background: #f8fafc; padding: 6px 12px; border-radius: 50px; border: 1px solid var(--border);
            display: flex; align-items: center; gap: 6px;
        }

        /* --- 3. MOBILE APP BAR (NEW) --- */
        .mobile-app-bar {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--app-bar-h);
            background: #ffffff; border-top: 1px solid var(--border);
            z-index: 1000; display: grid; grid-template-columns: repeat(4, 1fr);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.03);
        }
        
        .app-bar-btn {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            gap: 4px; color: var(--text-muted); text-decoration: none; font-size: 0.7rem; font-weight: 500;
            transition: color 0.2s;
        }
        .app-bar-btn svg { width: 22px; height: 22px; }
        .app-bar-btn:hover, .app-bar-btn:active { color: var(--primary); }
        .app-bar-btn.highlight { color: #b45309; font-weight: 600; } /* Highlight for offers */

        /* --- 4. HOME VIEW & HERO --- */
        #home-view { padding-top: var(--header-h); min-height: 100vh; display: flex; flex-direction: column; background: var(--bg); }
        
        .hero {
            background: #ffffff; padding: 40px 0; text-align: center;
            border-bottom: 1px solid #f1f5f9; position: relative; overflow: hidden;
        }
        .hero::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(220, 38, 38, 0.01) 0%, transparent 70%);
            z-index: 0; pointer-events: none;
        }
        .hero .container { position: relative; z-index: 1; }

        .badge-trust {
            display: inline-flex; align-items: center; gap: 6px;
            background: #f0fdf4; color: #15803d; font-size: 0.8rem; font-weight: 600;
            padding: 6px 16px; border-radius: 50px; margin-bottom: 16px;
            border: 1px solid #dcfce7; text-transform: uppercase; letter-spacing: 0.5px;
        }

        .hero h1 { 
            font-size: 2rem; font-weight: 700; color: var(--secondary); 
            margin-bottom: 16px; letter-spacing: -0.02em; line-height: 1.1; 
        }
        .hero h1 span { color: var(--primary); }

        .hero p { 
            color: var(--text-muted); font-size: 1.05rem; max-width: 600px; 
            margin: 0 auto 24px; line-height: 1.5; font-weight: 400;
        }

        /* Features Bar */
        .features-bar {
            display: flex; justify-content: center; flex-wrap: wrap; gap: 12px; margin-top: 24px;
        }
        .feature-item {
            display: flex; align-items: center; gap: 6px; background: white;
            padding: 8px 14px; border-radius: 8px; border: 1px solid #f1f5f9;
            box-shadow: 0 2px 4px rgba(0,0,0,0.01); font-size: 0.85rem; font-weight: 500; color: var(--text-main);
        }
        .feature-icon { color: var(--primary); display: flex; align-items: center; }

        /* CTA Button */
        .btn-hero-cta {
            display: inline-flex; align-items: center; background: var(--primary); color: white;
            font-weight: 600; padding: 14px 32px; border-radius: 50px; font-size: 1.1rem;
            box-shadow: 0 4px 14px rgba(220, 38, 38, 0.2); transition: transform 0.2s;
        }
        .btn-hero-cta:hover { transform: scale(1.02); background: var(--primary-dark); }

        @media (min-width: 768px) {
            .hero { padding: 80px 0 60px; }
            .hero h1 { font-size: 3.5rem; }
            .hero p { font-size: 1.25rem; }
            .badge-trust { font-size: 0.9rem; }
            .feature-item { padding: 10px 16px; font-size: 0.9rem; }
        }

        /* Baskets Grid */
        .baskets-grid { display: grid; grid-template-columns: 1fr; gap: 24px; padding-bottom: 60px; list-style: none; }
        @media (min-width: 640px) { .baskets-grid { grid-template-columns: repeat(2, 1fr); } }
        /* DESKTOP HOME GRID - Compact */
        @media (min-width: 1024px) { 
            .baskets-grid { grid-template-columns: repeat(4, 1fr); gap: 20px; } 
        }
        
        .big-card { 
            background: var(--surface); border-radius: 16px; overflow: hidden; 
            display: flex; flex-direction: column; transition: transform 0.2s ease, box-shadow 0.2s ease; height: 100%;
            border: 1px solid var(--border); position: relative;
        }
        .big-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-md); }

        .bc-image-box { 
            width: 100%; aspect-ratio: 1/1; background: #fff; position: relative; 
            border-bottom: 1px solid #f8fafc; display: flex; align-items: center; justify-content: center; 
            padding: 20px; cursor: zoom-in; overflow: hidden;
        }
        
        .img-fade-in { opacity: 0; transition: opacity 0.5s ease-out; }
        .img-fade-in.visible { opacity: 1; }
        @keyframes safeFadeIn { from { opacity: 0; } to { opacity: 1; } }
        .img-fade-in { animation: safeFadeIn 0.5s ease-out 2s forwards; }

        .bc-image { width: 100%; height: 100%; object-fit: contain; transition: transform 0.5s ease; mix-blend-mode: multiply; }
        .big-card:hover .bc-image { transform: scale(1.05); }
        
        .bc-content { padding: 20px; display: flex; flex-direction: column; flex: 1; text-align: center; }
        
        .bc-title { font-size: 1.4rem; font-weight: 600; color: var(--secondary); margin-bottom: 6px; line-height: 1.2; }
        .bc-price { font-size: 1.4rem; font-weight: 700; color: var(--primary); margin-bottom: 20px; font-feature-settings: "tnum"; }
        
        .bc-actions { display: grid; gap: 10px; margin-top: auto; }
        .btn-full { 
            width: 100%; min-height: 48px; padding: 0 20px; border-radius: 50px; 
            font-weight: 600; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.2s;
        }
        .btn-customize { background: var(--secondary); color: white; }
        .btn-customize:hover { background: #1e293b; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .btn-whatsapp-outline { background: white; color: var(--secondary); border: 1px solid var(--border); }
        .btn-whatsapp-outline:hover { border-color: var(--secondary); background: #f8fafc; }

        /* --- 5. CUSTOMIZER VIEW --- */
        #customizer-view { padding-top: var(--header-h); background: #ffffff; min-height: 100vh; }
        
        .customizer-header { 
            background: rgba(255,255,255,0.98); padding: 8px 0; border-bottom: 1px solid var(--border); 
            position: sticky; top: var(--header-h); z-index: 90; backdrop-filter: blur(10px); transition: top 0.3s ease;
        }
        body.header-hidden .customizer-header { top: 0; }

        .ch-inner { display: flex; flex-wrap: wrap; align-items: center; gap: 12px; }
        
        .left-group { display: flex; gap: 12px; align-items: center; flex: 1; min-width: 140px; }
        .btn-back { 
            width: 44px; height: 44px; border-radius: 50%; background: white; border: 1px solid var(--border);
            display: flex; align-items: center; justify-content: center; font-size: 1.1rem; color: var(--secondary); flex-shrink: 0;
            transition: background 0.2s;
        }
        .btn-back:hover { background: #f1f5f9; border-color: var(--text-muted); }
        
        .cust-basket-info h2 { font-size: 1.1rem; font-weight: 700; line-height: 1.2; margin: 0; color: var(--secondary); }
        .cust-basket-info span { font-size: 0.85rem; color: var(--text-muted); font-weight: 400; }
        
        .search-row { width: 100%; margin-top: 5px; display: flex; align-items: center; gap: 8px; }
        .search-container { flex: 1; position: relative; }
        .search-input {
            width: 100%; height: 44px; padding: 0 40px 0 16px;
            border-radius: 50px; border: 1px solid var(--border); background: #f8fafc;
            font-size: 1rem; color: var(--text-main); transition: border-color 0.2s;
        }
        .search-input:focus { outline: none; border-color: var(--text-muted); background: white; }
        .search-icon { position: absolute; right: 14px; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; color: var(--text-muted); pointer-events: none; }

        .changes-counter { 
            font-size: 0.8rem; font-weight: 600; color: #b45309; 
            background: #fffbeb; padding: 0 12px; height: 40px; border-radius: 50px; 
            border: 1px solid #fde68a; white-space: nowrap; display: flex; align-items: center;
        }
        .changes-counter.limit-reached { color: #b91c1c; background: #fee2e2; border-color: #fca5a5; }

        .desktop-actions { display: none; } /* HIDDEN ON MOBILE */

        .customizer-grid { display: block; margin-top: 24px; }
        .products-col { padding-bottom: 120px; } 
        
        /* Section Banner */
        .section-banner {
            width: 100%; padding: 14px 20px; margin-bottom: 0; border-radius: 12px 12px 0 0;
            display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid transparent;
        }
        .section-banner h3 {
            font-size: 1.1rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;
            display: flex; align-items: center; gap: 10px; margin: 0; line-height: 1.2;
        }
        
        .extras-separator-banner {
            text-align: center; padding: 40px 20px 20px; margin-bottom: 10px; border-bottom: 1px solid transparent;
        }
        .extras-separator-banner h3 {
            font-size: 1.5rem; font-weight: 300; color: var(--secondary); margin-bottom: 8px; letter-spacing: -0.5px;
        }
        .extras-separator-banner p { color: var(--text-muted); font-size: 0.95rem; font-weight: 400; }

        /* Generic Category Box */
        .category-box {
            border: none; border-radius: 0 0 12px 12px; padding: 10px 16px 16px; margin-bottom: 30px;
            background-color: #ffffff !important;
        }
        
        .basket-grid, .extras-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; list-style: none;
        }
        @media(min-width: 600px) { .basket-grid, .extras-grid { grid-template-columns: repeat(3, 1fr); gap: 16px; } }

        /* PRODUCT CARD */
        .product-card {
            background: transparent; padding: 0 0 16px 0; border-bottom: 1px solid #f1f5f9;
            display: flex; flex-direction: column; align-items: center; text-align: center;
            gap: 8px; transition: all 0.2s; position: relative;
        }
        .category-box .product-card:last-child { border-bottom: none; }
        
        .pc-img-box { 
            width: 100%; aspect-ratio: 1/1; flex-shrink: 0; 
            display: flex; align-items: center; justify-content: center;
            cursor: zoom-in; background: transparent; position: relative; margin-bottom: 4px;
        }
        .pc-img { width: 100%; height: 100%; object-fit: contain; mix-blend-mode: multiply; }
        
        .pc-offer-tag {
            position: absolute; top: 0; left: 0; background: #16a34a; color: white;
            font-size: 0.65rem; font-weight: 700; padding: 4px 8px; border-radius: 0 0 8px 0;
            text-transform: uppercase; box-shadow: 0 2px 4px rgba(0,0,0,0.1); z-index: 5;
        }
        
        .price-container { display: flex; align-items: center; justify-content: center; gap: 8px; }
        .price-old { text-decoration: line-through; color: #94a3b8; font-size: 0.8rem; }
        .price-new { color: #dc2626; font-weight: 700; font-size: 0.95rem; }

        .media-indicators {
            position: absolute; bottom: 6px; right: 6px; display: flex; gap: 4px; pointer-events: none;
        }
        
        .indicator-icon {
            background: rgba(255,255,255,0.95); color: var(--secondary); border: 1px solid #e2e8f0;
            border-radius: 50%; width: 26px; height: 26px; display: flex; align-items: center; justify-content: center;
            opacity: 0; transition: opacity 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .indicator-icon.visible { opacity: 1; }

        .pc-name { 
            font-size: 0.8rem; font-weight: 500; line-height: 1.35; color: var(--secondary); 
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
            height: 2.7em; margin: 0; width: 100%;
        }
        .pc-price { font-size: 0.95rem; font-weight: 600; color: var(--text-main); font-feature-settings: "tnum"; }
        
        .pc-meta { font-size: 0.75rem; color: var(--text-muted); font-weight: 500; background: rgba(0,0,0,0.05); padding: 2px 8px; border-radius: 4px; width: fit-content; margin: 0 auto; }
        
        .pc-validity { font-size: 0.75rem; color: #65a30d; font-weight: 500; margin-top: -2px; margin-bottom: 4px; }

        .btn-nutri {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 4px 10px; border: 1px solid #e2e8f0; background: #fff;
            border-radius: 50px; font-size: 0.7rem; color: #475569; margin-bottom: 8px;
            cursor: pointer; transition: all 0.2s; display: none;
        }
        .btn-nutri:hover { background: #f1f5f9; border-color: #cbd5e1; color: var(--secondary); }

        .btn-features {
            display: inline-flex; align-items: center; justify-content: center; gap: 4px;
            padding: 4px 12px; border: 1px solid #bfdbfe; background: #eff6ff;
            border-radius: 50px; font-size: 0.7rem; color: #1d4ed8; margin-bottom: 8px;
            cursor: pointer; transition: all 0.2s; font-weight: 500;
        }
        .btn-features:hover { background: #dbeafe; border-color: #93c5fd; }
        .btn-features + .btn-nutri, .btn-nutri + .btn-features { margin-top: 4px; }

        .pc-actions { width: 100%; margin-top: auto; }
        
        .btn-add-sm {
            height: 36px; width: 100%; padding: 0 16px; border-radius: 6px; border: none;
            font-size: 0.8rem; font-weight: 700; text-transform: uppercase;
            background: var(--primary); color: white; cursor: pointer;
            transition: all 0.2s; box-shadow: 0 2px 4px rgba(220, 38, 38, 0.15);
        }
        .btn-add-sm:hover { background: var(--primary-dark); }
        
        .qty-control { 
            display: flex; align-items: center; justify-content: space-between;
            background: white; border: 1px solid var(--primary); border-radius: 6px;
            height: 36px; width: 100%;
        }
        .qty-btn { width: 32px; height: 100%; font-size: 1.2rem; color: var(--secondary); display:flex; align-items:center; justify-content:center; }
        .qty-val { font-weight: 600; font-size: 0.95rem; color: var(--secondary); }

        /* DESKTOP TWEAKS - CRITICAL ADJUSTMENTS */
        @media(min-width: 1024px) {
            body { padding-bottom: 0; } /* Remove App Bar padding on Desktop */
            .container { padding: 0 40px; }
            .hero h1 { font-size: 3rem; }
            .hero p { font-size: 1.15rem; }
            
            .ch-inner { flex-wrap: nowrap; justify-content: space-between; }
            .search-row { width: auto; flex: 1; max-width: 450px; margin: 0 20px; }
            
            .desktop-actions { 
                display: flex; align-items: center; gap: 16px; 
                padding-left: 20px; border-left: 1px solid #f1f5f9;
            }
            .desktop-total-info { display: flex; flex-direction: column; align-items: flex-end; line-height: 1.2; }
            .desktop-total-info .lbl { font-size: 0.75rem; text-transform: uppercase; color: var(--text-muted); font-weight: 600; }
            .desktop-total-info .val { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
            
            .btn-header-checkout {
                background: #16a34a; color: white; padding: 0 20px; height: 44px;
                border-radius: 6px; font-weight: 600; font-size: 0.9rem;
                display: flex; align-items: center; gap: 8px; cursor: pointer;
                box-shadow: 0 4px 12px rgba(22, 163, 74, 0.15); transition: transform 0.2s;
            }
            .btn-header-checkout:hover { background: #15803d; transform: translateY(-1px); }

            /* SIDEBAR EXPANSION: 360px (Approx 60% larger than 220px standard) */
            .customizer-grid { display: grid; grid-template-columns: 1fr 360px; gap: 30px; align-items: start; }
            .products-col { padding-bottom: 60px; }
            
            /* DESKTOP PRODUCT GRID: FIXED 4 COLUMNS */
            .basket-grid, .extras-grid { 
                grid-template-columns: repeat(4, 1fr) !important; 
                gap: 16px; 
            }
            
            /* COMPACT CARD STYLING FOR DESKTOP */
            .product-card { 
                padding: 12px; gap: 8px; height: 100%; border-bottom: none; border: 1px solid transparent; border-radius: 12px;
            }
            .product-card:hover { border-color: var(--border); background: white; } 
            
            .pc-name { font-size: 0.8rem; height: 2.6em; line-height: 1.3; }
            .pc-price { font-size: 0.9rem; margin-bottom: 4px; }
            .btn-add-sm, .qty-control { height: 34px; font-size: 0.75rem; border-radius: 6px; }
            
            /* Hide Mobile Elements */
            .order-summary-card { display: none !important; }
            .mobile-app-bar { display: none !important; }
            
            /* Hide Floating Buttons */
            .fab-btn { display: none !important; }
            /* Exception: Scroll top still useful? Maybe disable if sidebar has nav. Let's keep scroll top but move it. */
            #btn-scroll-top { display: flex !important; right: 40px; bottom: 40px; }

            .sidebar-col { display: flex; flex-direction: column; gap: 20px; align-self: start; }

            .desktop-cat-nav { 
                display: block !important; background: white; padding: 12px;
                border-radius: 16px; border: 1px solid var(--border);
                max-height: calc(100vh - 120px); overflow-y: auto;
            }

            /* UNIFIED SIDEBAR GRID: 3 COLUMNS */
            #desktop-cat-list, #desktop-tags-list {
                display: grid;
                grid-template-columns: repeat(3, 1fr); /* 3 COLUMNS */
                gap: 6px;
            }

            .desktop-cat-link, .tag-chip { 
                display: flex; align-items: center; justify-content: center;
                text-align: center;
                padding: 0 4px;
                color: var(--secondary);
                transition: 0.2s; cursor: pointer; 
                font-weight: 600; font-size: 0.7rem; 
                background: #f8fafc; 
                border: 1px solid #f1f5f9;
                border-radius: 6px; 
                text-transform: uppercase; letter-spacing: 0.5px;
                height: 36px; /* Uniform Height */
                width: 100%;
                white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            }
            .desktop-cat-link:hover, .tag-chip:hover { border-color: var(--border); background: #e2e8f0; color: var(--primary); }

            #desktop-tags-container {
                background: white; padding: 12px; border-radius: 16px; border: 1px solid var(--border);
            }
        }
        .desktop-cat-nav { display: none; }

        /* Mobile Compact Category List */
        #mobile-cat-list { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding-bottom: 20px; }
        #mobile-cat-list .cat-link {
            border: 1px solid #f1f5f9; border-radius: 8px; padding: 10px; text-align: center; font-size: 0.9rem; color: var(--secondary); background: #f8fafc;
        }

        /* FOOTER STYLES */
        .footer-contacts { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-bottom: 20px; }
        .footer-btn {
            display: flex; align-items: center; gap: 8px; background: #f1f5f9; color: var(--secondary);
            padding: 8px 16px; border-radius: 50px; text-decoration: none; font-weight: 600; font-size: 0.9rem;
            border: 1px solid #e2e8f0; transition: background 0.2s;
        }
        .footer-btn:hover { background: #e2e8f0; }
        
        .footer-social-row { display: flex; justify-content: center; gap: 16px; margin-bottom: 20px; }
        .btn-social {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            width: 140px; height: 40px; border-radius: 50px; text-decoration: none;
            font-weight: 600; font-size: 0.9rem; color: white;
        }
        .btn-social.whatsapp { background: #166534; }
        .btn-social.instagram { background: #be185d; }
        .btn-social:hover { opacity: 0.9; transform: translateY(-1px); }

        .credit-toast {
            position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px);
            background: var(--secondary); color: white; padding: 12px 24px; border-radius: 50px;
            font-size: 0.95rem; font-weight: 600; box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            opacity: 0; pointer-events: none; transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); z-index: 95;
            display: flex; align-items: center; gap: 10px; white-space: nowrap;
        }
        .credit-toast.visible { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }

        /* DIALOG/MODAL */
        dialog {
            border: none; border-radius: 12px; padding: 0; 
            background: white; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
            max-width: 450px; width: 95%; margin: auto;
        }
        dialog::backdrop { background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); }
        
        .modal-header { padding: 12px 20px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; background: #fafafa; }
        .modal-title { font-size: 1.1rem; font-weight: 600; color: var(--secondary); }
        .modal-close { width: 32px; height: 32px; border-radius: 50%; background: #fff; border: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; cursor: pointer; color: var(--text-muted); transition: background 0.2s; }
        .modal-close:hover { background: #f1f5f9; }
        
        .modal-body { padding: 20px; max-height: 60vh; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        
        .checkout-list { list-style: none; margin-bottom: 20px; border: 1px solid #f1f5f9; border-radius: 8px; overflow: hidden; }
        .checkout-item { 
            display: flex; justify-content: space-between; padding: 10px 16px; 
            border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; color: var(--text-main); font-weight: 400; background: white;
        }
        .checkout-item:last-child { border-bottom: none; }
        .checkout-item span:first-child { font-weight: 500; color: var(--secondary); }
        
        .checkout-total-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding: 0 8px; }
        .checkout-total-lbl { font-size: 1rem; color: var(--text-muted); }
        .checkout-total-val { font-size: 1.4rem; font-weight: 700; color: var(--primary); }

        .payment-section h4 { font-size: 0.9rem; font-weight: 600; margin-bottom: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        .payment-options { display: grid; gap: 8px; }
        .payment-opt { 
            display: flex; align-items: center; gap: 10px; padding: 12px; 
            border: 1px solid #e2e8f0; border-radius: 6px; cursor: pointer; transition: all 0.2s;
            font-size: 0.9rem;
        }
        .payment-opt:hover { background: #f8fafc; border-color: #cbd5e1; }
        .payment-opt:has(input:checked) { border-color: var(--primary); background: #fef2f2; }
        .payment-opt input { accent-color: var(--primary); width: 18px; height: 18px; }

        .modal-footer { padding: 16px 20px; background: #f8fafc; border-top: 1px solid #e2e8f0; }
        .btn-confirm { width: 100%; height: 44px; background: #16a34a; color: white; border-radius: 6px; font-weight: 600; font-size: 1rem; }
        .btn-confirm:hover { background: #15803d; }

        /* SCROLL BUTTON */
        .fab-btn {
            width: 48px; height: 48px; position: fixed; bottom: 80px; right: 16px; z-index: 90;
            border-radius: 50%; background: white; 
            border: 1px solid var(--border); box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: flex; align-items: center; justify-content: center; color: var(--secondary); font-size: 1.2rem;
            transition: transform 0.2s, opacity 0.2s; opacity: 0; pointer-events: none;
        }
        .fab-btn.visible { opacity: 1; pointer-events: auto; }
        .fab-btn.active { transform: scale(0.95); }
        
        /* SHEETS */
        .cat-sheet {
            position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 200;
            display: flex; flex-direction: column; justify-content: flex-end;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .cat-sheet.open { opacity: 1; pointer-events: auto; }
        .cat-sheet-content {
            background: white; border-radius: 20px 20px 0 0; padding: 24px; max-height: 80vh; overflow-y: auto;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .cat-sheet.open .cat-sheet-content { transform: translateY(0); }
        .cat-link { display: block; padding: 16px 0; border-bottom: 1px solid #f1f5f9; font-weight: 500; color: var(--text-main); font-size: 1.1rem; cursor: pointer; }

        /* TAGS SHEET MOBILE */
        #mobile-tags-list {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding-bottom: 20px;
        }
        .tag-btn-mobile {
            border: 1px solid #e2e8f0; border-radius: 6px; padding: 8px 4px; text-align: center;
            font-size: 0.8rem; color: var(--secondary); background: #f8fafc; font-weight: 500;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        /* GALLERY */
        .gallery-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 300;
            display: flex; flex-direction: column; opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .gallery-overlay.open { opacity: 1; pointer-events: auto; }
        .gallery-stage { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; position: relative; }
        .gallery-img { max-width: 100%; max-height: 100%; object-fit: contain; transform: scale(0.95); transition: transform 0.3s; }
        .gallery-video { max-width: 100%; max-height: 100%; }
        .gallery-overlay.open .gallery-img { transform: scale(1); }
        .gallery-close { position: absolute; top: 20px; right: 20px; color: white; font-size: 2rem; padding: 20px; cursor: pointer; z-index: 310; }
        .gallery-thumbs { height: 100px; display: flex; justify-content: center; gap: 10px; padding: 20px; overflow-x: auto; }
        .g-thumb { width: 60px; height: 60px; border-radius: 6px; border: 2px solid transparent; opacity: 0.5; object-fit: cover; cursor: pointer; }
        .g-thumb.active { border-color: white; opacity: 1; }

        details.faq-item { background: white; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 12px; overflow: hidden; }
        details.faq-item summary { padding: 18px; cursor: pointer; font-weight: 500; display: flex; justify-content: space-between; list-style: none; align-items: center; color: var(--secondary); font-size: 1.05rem; }
        details.faq-item summary::after { content: "+"; font-size: 1.5rem; color: var(--primary); line-height: 0.5; font-weight: 600; }
        details.faq-item[open] summary::after { content: "-"; }
        .faq-answer { padding: 18px; color: var(--text-muted); line-height: 1.6; border-top: 1px solid #f3f4f6; font-weight: 300; }
    </style>
</head>
<body>

    <header>
        <div class="container header-inner">
            <a href="#" class="logo" onclick="location.reload()" aria-label="Dona Ant√¥nia - Voltar ao in√≠cio">
                <div class="logo-div" aria-hidden="true">DA</div>
                <span>Dona Ant√¥nia</span>
            </a>
            <div class="location-badge">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                Cuiab√° & VG
            </div>
        </div>
    </header>

    <!-- MOBILE APP BAR (NAV INFERIOR) -->
    <nav class="mobile-app-bar" id="mobile-app-bar" style="display:none;">
        <a onclick="App.toggleCategorySheet()" class="app-bar-btn">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
            <span>Categorias</span>
        </a>
        <a onclick="App.toggleTagsSheet()" class="app-bar-btn">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            <span>Busca</span>
        </a>
        <a onclick="App.toggleOffersSheet()" class="app-bar-btn highlight">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path></svg>
            <span>OFERTAS</span>
        </a>
        <a onclick="App.toggleFAQSheet()" class="app-bar-btn">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <span>D√∫vidas</span>
        </a>
    </nav>

    <!-- SCROLL BUTTON (Mantido Flutuante) -->
    <button id="btn-scroll-top" class="fab-btn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" aria-label="Voltar ao topo">
        <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
    </button>

    <!-- CATEGORY SHEET (MOBILE) -->
    <div id="cat-sheet" class="cat-sheet" onclick="if(event.target === this) App.toggleCategorySheet()">
        <aside class="cat-sheet-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="font-weight:600; color:var(--secondary); margin:0;">Categorias</h3>
                <button onclick="App.toggleCategorySheet()" aria-label="Fechar Categorias" style="font-size:1.5rem; padding:10px; border:none; background:none;">‚úï</button>
            </div>
            <nav id="mobile-cat-list"></nav>
        </aside>
    </div>

    <!-- TAGS SHEET (MOBILE) -->
    <div id="tags-sheet" class="cat-sheet" onclick="if(event.target === this) App.toggleTagsSheet()">
        <aside class="cat-sheet-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="font-weight:600; color:var(--secondary); margin:0;">Busca R√°pida</h3>
                <button onclick="App.toggleTagsSheet()" aria-label="Fechar Tags" style="font-size:1.5rem; padding:10px; border:none; background:none;">‚úï</button>
            </div>
            <nav id="mobile-tags-list"></nav>
        </aside>
    </div>

    <!-- NEW: OFFERS SHEET (MOBILE ONLY) -->
    <div id="offers-sheet" class="cat-sheet" onclick="if(event.target === this) App.toggleOffersSheet()">
        <aside class="cat-sheet-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #f1f5f9; padding-bottom:10px;">
                <h3 style="font-weight:700; color:#b45309; margin:0;">üî• Super Ofertas</h3>
                <button onclick="App.toggleOffersSheet()" aria-label="Fechar Ofertas" style="font-size:1.5rem; padding:10px; border:none; background:none;">‚úï</button>
            </div>
            <div id="mobile-offers-list" class="basket-grid" style="grid-template-columns: 1fr 1fr; gap:16px;">
                <!-- Offers injected via JS -->
            </div>
        </aside>
    </div>

    <!-- FEATURES SHEET (Characteristics) -->
    <div id="char-sheet" class="cat-sheet" onclick="if(event.target === this) App.toggleFeatures()">
        <aside class="cat-sheet-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #f1f5f9; padding-bottom:12px;">
                <h3 id="char-title" style="font-weight:600; color:var(--secondary); margin:0; font-size:1.1rem; padding-right:10px;">Caracter√≠sticas</h3>
                <button onclick="App.toggleFeatures()" aria-label="Fechar Caracter√≠sticas" style="font-size:1.5rem; padding:10px; border:none; background:none; cursor:pointer;">‚úï</button>
            </div>
            <div id="char-body" style="color:var(--text-main); font-size:1rem; line-height:1.6; max-height:60vh; overflow-y:auto; white-space: pre-wrap;">
            </div>
        </aside>
    </div>

    <!-- FAQ SHEET (MOBILE) -->
    <div id="faq-sheet" class="cat-sheet" onclick="if(event.target === this) App.toggleFAQSheet()">
        <aside class="cat-sheet-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="font-weight:600; color:var(--secondary); margin:0;">D√∫vidas Frequentes</h3>
                <button onclick="App.toggleFAQSheet()" aria-label="Fechar FAQ" style="font-size:1.5rem; padding:10px; border:none; background:none;">‚úï</button>
            </div>
            <div id="faq-sheet-content-body" style="max-height: 60vh; overflow-y: auto;">
                <details class="faq-item"><summary>Quais s√£o as formas de pagamento?</summary><div class="faq-answer">Aceitamos Dinheiro, Pix, Cart√£o de D√©bito, Cart√£o de Cr√©dito (at√© 3x sem juros) e cart√µes alimenta√ß√£o/refei√ß√£o (Pluxee, Alelo, Flash, Caju, iFood).</div></details>
                <details class="faq-item"><summary>Eu pago s√≥ na entrega do pedido?</summary><div class="faq-answer">Sim! Para sua seguran√ßa, voc√™ faz o pagamento somente no momento da entrega do pedido na sua casa.</div></details>
                <details class="faq-item"><summary>A entrega √© gr√°tis?</summary><div class="faq-answer">Sim, o frete √© Gr√°tis para compras acima de R$ 85,00. Pedidos de menor valor possuem taxa fixa de R$ 15,00.</div></details>
                <details class="faq-item"><summary>Posso trocar itens da cesta b√°sica?</summary><div class="faq-answer">Com certeza! Utilize nosso personalizador online clicando em "Personalizar" ou fale com o atendente pelo WhatsApp.</div></details>
                <details class="faq-item"><summary>De qual cidade voc√™s s√£o?</summary><div class="faq-answer">Somos de Cuiab√°, MT. Estamos localizados no bairro Jardim Nossa Senhora Aparecida.</div></details>
                <details class="faq-item"><summary>Quanto tempo demora a entrega?</summary><div class="faq-answer">Nossas entregas s√£o realizadas no dia seguinte ao pedido, de segunda a s√°bado (delivery r√°pido e agendado).</div></details>
            </div>
        </aside>
    </div>

    <!-- CREDIT TOAST -->
    <div id="credit-toast" class="credit-toast" role="status" aria-live="polite">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        <span id="credit-text">Cr√©dito dispon√≠vel: R$ 0,00</span>
    </div>

    <!-- HOME VIEW -->
    <main id="home-view">
        <section class="hero">
            <div class="container">
                <div class="badge-trust">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                    Pagamento 100% Seguro na Entrega
                </div>

                <h1>
                    A Melhor Cesta B√°sica <br class="hidden-mobile">
                    na Porta da <span>Sua Casa</span>
                </h1>
                
                <p>
                    Sem filas e sem carregar peso. Personalize com marcas l√≠deres como 
                    <strong>Arroz Tio Alvino</strong> e receba amanh√£ em Cuiab√° e VG.
                </p>

                <button class="btn-hero-cta" onclick="document.getElementById('baskets-list').scrollIntoView({behavior: 'smooth'})">
                    Escolher Minha Cesta
                    <svg style="margin-left:8px;" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                </button>

                <div class="features-bar">
                    <div class="feature-item">
                        <span class="feature-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg></span>
                        Entrega Gr√°tis*
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></span>
                        Entrega em 24h
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg></span>
                        Aceitamos Cart√£o/Vale
                    </div>
                </div>
            </div>
        </section>

        <section class="container" aria-label="Lista de Cestas">
            <div id="baskets-list" class="baskets-grid">
                <div style="padding:40px; text-align:center;">
                    <div class="loading-spinner"></div>
                    <p>Carregando melhores ofertas...</p>
                </div>
            </div>
        </section>

        <section class="container faq-section" style="padding-top: 60px; padding-bottom: 20px;">
            <h2 style="font-size: 1.5rem; margin-bottom: 24px; color: var(--secondary); font-weight: 700; text-align: center;">D√∫vidas Frequentes</h2>
            
            <div itemscope itemtype="https://schema.org/FAQPage">
                <details class="faq-item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
                    <summary itemprop="name">Quais s√£o as formas de pagamento?</summary>
                    <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer" class="faq-answer">
                        <span itemprop="text">Dinheiro, Pix, Cart√£o de D√©bito, Cart√£o de Cr√©dito (parcelado em at√© 3x sem juros), Cart√µes Alimenta√ß√£o e Refei√ß√£o Pluxee, Alelo, Flash, Caju, iFood.</span>
                    </div>
                </details>
                <details class="faq-item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
                    <summary itemprop="name">Eu pago s√≥ na entrega do pedido?</summary>
                    <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer" class="faq-answer">
                        <span itemprop="text">Sim! Para sua seguran√ßa, voc√™ faz o pagamento somente no momento da entrega do pedido na sua casa.</span>
                    </div>
                </details>
                <details class="faq-item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
                    <summary itemprop="name">A entrega √© gr√°tis?</summary>
                    <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer" class="faq-answer">
                        <span itemprop="text">Sim, o frete √© Gr√°tis para compras acima de R$ 85,00. Pedidos de menor valor possuem taxa fixa de R$ 15,00.</span>
                    </div>
                </details>
                <details class="faq-item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
                    <summary itemprop="name">Posso trocar itens da cesta b√°sica?</summary>
                    <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer" class="faq-answer">
                        <span itemprop="text">Com certeza! Utilize nosso personalizador online clicando em "Personalizar" ou fale com o atendente pelo WhatsApp.</span>
                    </div>
                </details>
                <details class="faq-item">
                    <summary>Confira os Bairros Atendidos (Cuiab√° e VG)</summary>
                    <div class="faq-answer">
                        <p>A Dona Ant√¥nia √© refer√™ncia na distribui√ß√£o de cestas b√°sicas na baixada cuiabana. Frota pr√≥pria e pontualidade.</p>
                        <div style="margin-top: 15px;">
                            <strong style="color: var(--secondary);">Cuiab√° (Zona Oeste):</strong>
                            <p style="font-size: 0.9rem; margin-bottom: 10px;">Alvorada, Ara√©s, Centro, Cidade Alta, Cidade Verde, Coophamil, Goiabeiras, Jardim Cuiab√°, Porto, Quilombo, Santa Rosa, Verd√£o e regi√£o.</p>
                            <strong style="color: var(--secondary);">Cuiab√° (Zona Norte):</strong>
                            <p style="font-size: 0.9rem; margin-bottom: 10px;">CPA (I, II, III, IV), Centro Pol√≠tico, Morada da Serra, Morada do Ouro, Tr√™s Barras, Jardim Vit√≥ria, Nova Conquista.</p>
                        </div>
                    </div>
                </details>
            </div>
        </section>
        
        <footer style="margin-top: auto; padding: 40px 20px; text-align: center; color: var(--text-muted); font-size: 0.9rem; border-top: 1px solid var(--border); background: #fff;">
            <div class="footer-contacts">
                <a href="tel:5565996813588" class="footer-btn">üìû 99681-3588</a>
                <a href="tel:5565998150975" class="footer-btn">üìû 99815-0975</a>
            </div>
            <div class="footer-social-row">
                <a href="https://api.whatsapp.com/send?phone=5565996813588" target="_blank" class="btn-social whatsapp">WhatsApp</a>
                <a href="https://www.instagram.com/cestas.dona.antonia.cuiaba.vg/" target="_blank" class="btn-social instagram">Instagram</a>
            </div>
            <p style="margin-bottom: 10px;">¬© 2024 <strong>Dona Ant√¥nia Alimentos</strong>. Todos os direitos reservados.</p>
            <p style="font-size: 0.8rem;">CNPJ: XX.XXX.XXX/0001-XX | Rua Trinta, 105 - Cuiab√°, MT</p>
        </footer>
    </main>

    <!-- CUSTOMIZER VIEW -->
    <div id="customizer-view" class="hidden">
        <div class="customizer-header">
            <div class="container ch-inner">
                <div class="left-group">
                    <button class="btn-back" onclick="App.showHome()" aria-label="Voltar para a Home">‚ùÆ</button>
                    <div class="cust-basket-info">
                        <h2 id="cust-basket-name">Minha Cesta</h2>
                        <span>Personalize os itens abaixo</span>
                    </div>
                </div>
                
                <div class="search-row">
                    <div class="search-container">
                        <input type="text" id="product-search" class="search-input" placeholder="O que voc√™ procura?" aria-label="Buscar produtos na lista">
                        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                    <div id="changes-badge" class="changes-counter" style="display:none;" role="status">Exclu√≠dos: 0/0</div>
                </div>

                <div class="desktop-actions">
                    <div class="desktop-total-info">
                        <span class="lbl">Total</span>
                        <span class="val" id="header-total-val">R$ 0,00</span>
                    </div>
                    <button class="btn-header-checkout" onclick="App.openCheckout()">
                        <span>Encomendar (WhatsApp)</span>
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
                    </button>
                </div>

                <nav class="desktop-cat-nav" aria-label="Navega√ß√£o r√°pida de categorias">
                    <h3 style="margin-bottom:15px; font-weight:600; color:var(--secondary); font-size:1.1rem;">Navegar por Categoria</h3>
                    <div id="desktop-cat-list"></div>

                    <div style="margin-top:24px; padding-top:20px; border-top:1px solid #f1f5f9;">
                         <h3 style="margin-bottom:15px; font-weight:600; color:var(--secondary); font-size:1rem;">Busca R√°pida</h3>
                         <div id="desktop-tags-list"></div>
                    </div>
                </nav>
            </aside>
        </div>
    </div>

    <!-- GALLERY OVERLAY -->
    <div id="gallery-overlay" class="gallery-overlay" aria-modal="true" role="dialog" aria-label="Visualiza√ß√£o de Imagem">
        <button class="gallery-close" onclick="Gallery.close()" aria-label="Fechar Galeria">‚úï</button>
        <div class="gallery-stage" onclick="Gallery.close()">
            <img src="" id="gallery-img" class="gallery-img" onclick="event.stopPropagation()" alt="Imagem ampliada">
            <video id="gallery-video" class="gallery-video hidden" controls onclick="event.stopPropagation()"></video>
        </div>
        <div id="gallery-thumbs" class="gallery-thumbs"></div>
    </div>

    <!-- CHECKOUT MODAL -->
    <dialog id="checkout-modal">
        <div class="modal-header">
            <h3 class="modal-title">Confira seu Pedido</h3>
            <button class="modal-close" onclick="document.getElementById('checkout-modal').close()" aria-label="Fechar Janela">‚úï</button>
        </div>
        <div class="modal-body">
            <div class="checkout-total-row">
                <span class="checkout-total-lbl">Valor Total:</span>
                <span class="checkout-total-val" id="checkout-total">R$ 0,00</span>
            </div>
            <ul id="checkout-list" class="checkout-list"></ul>
            <div class="payment-section">
                <h4>Como prefere pagar na entrega?</h4>
                <div class="payment-options">
                    <label class="payment-opt">
                        <input type="radio" name="payment" value="Pix" checked>
                        <span>PIX (Instant√¢neo)</span>
                    </label>
                    <label class="payment-opt">
                        <input type="radio" name="payment" value="Dinheiro">
                        <span>Dinheiro / Esp√©cie</span>
                    </label>
                    <label class="payment-opt">
                        <input type="radio" name="payment" value="Cart√£o de Cr√©dito">
                        <span>Cart√£o de Cr√©dito (at√© 3x)</span>
                    </label>
                    <label class="payment-opt">
                        <input type="radio" name="payment" value="Cart√£o de D√©bito">
                        <span>Cart√£o de D√©bito</span>
                    </label>
                    <label class="payment-opt">
                        <input type="radio" name="payment" value="Cart√£o Alimenta√ß√£o">
                        <span>Cart√£o Alimenta√ß√£o/Refei√ß√£o</span>
                    </label>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-confirm" onclick="App.confirmCheckout()">
                Confirmar e Enviar via WhatsApp
            </button>
        </div>
    </dialog>

    <dialog id="faq-modal" style="max-width:600px;">
        <div class="modal-header">
            <h3 class="modal-title">D√∫vidas Frequentes</h3>
            <button class="modal-close" onclick="document.getElementById('faq-modal').close()" aria-label="Fechar Janela">‚úï</button>
        </div>
        <div class="modal-body">
            <details class="faq-item"><summary>Quais s√£o as formas de pagamento?</summary><div class="faq-answer">Aceitamos Dinheiro, Pix, Cart√£o de D√©bito, Cart√£o de Cr√©dito (at√© 3x sem juros) e cart√µes alimenta√ß√£o/refei√ß√£o (Pluxee, Alelo, Flash, Caju, iFood).</div></details>
            <details class="faq-item"><summary>Eu pago s√≥ na entrega do pedido?</summary><div class="faq-answer">Sim! Para sua seguran√ßa, voc√™ faz o pagamento somente no momento da entrega do pedido na sua casa.</div></details>
            <details class="faq-item"><summary>A entrega √© gr√°tis?</summary><div class="faq-answer">Sim, o frete √© Gr√°tis para compras acima de R$ 85,00. Pedidos de menor valor possuem taxa fixa de R$ 15,00.</div></details>
            <details class="faq-item"><summary>Posso trocar itens da cesta b√°sica?</summary><div class="faq-answer">Com certeza! Utilize nosso personalizador online clicando em "Personalizar" ou fale com o atendente pelo WhatsApp.</div></details>
            <details class="faq-item"><summary>De qual cidade voc√™s s√£o?</summary><div class="faq-answer">Somos de Cuiab√°, MT. Estamos localizados no bairro Jardim Nossa Senhora Aparecida.</div></details>
            <details class="faq-item"><summary>Quanto tempo demora a entrega?</summary><div class="faq-answer">Nossas entregas s√£o realizadas no dia seguinte ao pedido, de segunda a s√°bado (delivery r√°pido e agendado).</div></details>
        </div>
    </dialog>

    <script>
        /**
         * DONA ANT√îNIA APP CORE
         */
        
        const APP_TAGS = [
            "Arroz", "Feij√£o", "A√ß√∫car", "Caf√©", "√ìleo", 
            "Macarr√£o", "Biscoito", "Leite", "Farinha", "Sab√£o", 
            "Detergente", "Sardinha"
        ];

        const BASKET_LIMITS = { 
            'econ√¥mica': 5, 'economica': 5, 
            'mini': 7, 'pequena': 9, 'm√©dia': 11, 'media': 11, 'grande': 13 
        };

        const CATEGORY_THEMES = {
            'DEFAULT': { bar: '#f1f5f9', bg: '#f8fafc', text: '#334155' }, 
            'ALIMENTOS': { bar: '#ffedd5', bg: '#fff7ed', text: '#9a3412' }, 
            'LIMPEZA': { bar: '#dbeafe', bg: '#eff6ff', text: '#1e40af' }, 
            'HIGIENE': { bar: '#dcfce7', bg: '#f0fdf4', text: '#166534' }, 
            'BEBIDAS': { bar: '#fae8ff', bg: '#fdf4ff', text: '#86198f' }, 
            'HORTIFRUTI': { bar: '#fef9c3', bg: '#fefce8', text: '#854d0e' }, 
            'CARNES': { bar: '#fee2e2', bg: '#fef2f2', text: '#991b1b' } 
        };

        const Gallery = {
            open(mainSrc, productName, startWith = null) {
                const ol = document.getElementById('gallery-overlay');
                const img = document.getElementById('gallery-img');
                const video = document.getElementById('gallery-video');
                const thumbs = document.getElementById('gallery-thumbs');
                
                thumbs.innerHTML = '';
                img.src = startWith || mainSrc;
                img.alt = `Foto de ${productName}`;
                video.pause();
                video.src = "";
                video.classList.add('hidden');
                img.classList.remove('hidden');

                ol.classList.add('open');

                this.addThumb(mainSrc, 'image', !startWith);
                this.checkSuffixes(mainSrc, startWith);
                this.checkVideo(mainSrc);
            },

            addThumb(src, type, active) {
                const thumbs = document.getElementById('gallery-thumbs');
                const cls = active ? 'g-thumb active' : 'g-thumb';
                
                let el;
                if (type === 'video') {
                    el = document.createElement('div');
                    el.className = cls;
                    el.style.backgroundImage = 'url("img/video-placeholder.png")'; 
                    el.innerHTML = '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" style="color:#333"><path d="M8 5v14l11-7z"/></svg>';
                    el.style.display = 'flex'; el.style.alignItems = 'center'; el.style.justifyContent = 'center'; el.style.background = '#f1f5f9';
                } else {
                    el = document.createElement('img');
                    el.src = src; el.className = cls; el.onerror = () => { el.remove(); };
                }
                
                el.onclick = () => Gallery.swap(el, src, type);
                thumbs.appendChild(el);
            },

            checkSuffixes(mainSrc, startWith) {
                const lastDot = mainSrc.lastIndexOf('.');
                if(lastDot === -1) return;
                const base = mainSrc.substring(0, lastDot);
                const ext = mainSrc.substring(lastDot);
                const suffixes = ['A', 'B', 'C', 'D', 'E', 'F', 'G']; 
                
                let idx = 0;
                const tryNext = () => {
                    if (idx >= suffixes.length) return;
                    const suffix = suffixes[idx];
                    const testUrl = base + suffix + ext;
                    
                    const img = new Image();
                    img.onload = () => {
                        if (img.naturalWidth > 0) {
                            const isActive = (testUrl === startWith);
                            this.addThumb(testUrl, 'image', isActive);
                            idx++;
                            tryNext();
                        } else { return; }
                    };
                    img.onerror = () => { return; };
                    img.src = testUrl;
                };
                tryNext();
            },

            checkVideo(mainSrc) {
                const lastDot = mainSrc.lastIndexOf('.');
                if(lastDot === -1) return;
                const base = mainSrc.substring(0, lastDot);
                const videoUrl = base + '.mp4';

                const video = document.createElement('video');
                video.preload = 'metadata';
                video.onloadedmetadata = () => { this.addThumb(videoUrl, 'video', false); };
                video.src = videoUrl;
            },

            swap(el, src, type) {
                const img = document.getElementById('gallery-img');
                const video = document.getElementById('gallery-video');
                document.querySelectorAll('.g-thumb').forEach(t => t.classList.remove('active'));
                el.classList.add('active');

                if (type === 'video') {
                    img.classList.add('hidden'); video.src = src; video.classList.remove('hidden'); video.play();
                } else {
                    video.pause(); video.classList.add('hidden'); img.src = src; img.classList.remove('hidden');
                }
            },
            close() {
                const video = document.getElementById('gallery-video');
                video.pause();
                document.getElementById('gallery-overlay').classList.remove('open');
            }
        };

        const App = {
            data: [], cart: {}, originalCart: {}, baseFee: 0, currentBasket: null, currentLimit: 99, phone: "5565996813588", searchTerm: "", categories: [],

            async init() {
                try {
                    const response = await fetch('produtos/produtos.json?v=' + new Date().getTime());
                    const raw = await response.json();

                    this.data = raw.map(p => {
                        let imgPath = p.imagem || '';
                        if (imgPath && imgPath.includes('/')) {
                            const parts = imgPath.split('/');
                            const fileName = parts[parts.length - 1];
                            imgPath = `img/produtos/${fileName}`;
                        } else if (imgPath) {
                            imgPath = `img/produtos/${imgPath}`;
                        }

                        const isOffer = (p.Oferta && p.Oferta.toLowerCase() === 'sim');
                        const offerPrice = parseFloat(p.Valor_Oferta || 0);
                        const normalPrice = parseFloat(p.valor || 0);
                        const limitVal = parseInt(p.Limit || p.limit || 0);

                        return {
                            ...p, id: String(p.id), valor: normalPrice,
                            validade: (() => { const v = p.date || p.Validade || p.validade; return v ? v.split('-').reverse().join('/') : null; })(),
                            categoria: (p.categoria || 'OUTROS').toUpperCase().trim(),
                            imagem: imgPath, items: p.items || [], isOffer: isOffer,
                            offerPrice: offerPrice, estoque: parseInt(p.estoque || 0), limit: limitVal,
                            caracteristicas: p.caracteristicas || p.Caracteristicas || "",
                        };
                    });

                    this.renderHome();
                    this.setupScroll();
                    this.renderTags(); 
                    
                    document.getElementById('product-search').addEventListener('input', (e) => {
                        this.searchTerm = e.target.value.toLowerCase();
                        this.renderCustomizerLists(true);
                    });

                    document.getElementById('product-search').addEventListener('focus', () => {
                        setTimeout(() => {
                            const section = document.querySelector('.extras-separator-banner');
                            if(section) {
                                const headerOffset = 150; 
                                const elementPosition = section.getBoundingClientRect().top;
                                const offsetPosition = elementPosition + window.scrollY - headerOffset;
                                window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                            }
                        }, 300);
                    });

                } catch (e) {
                    console.error("Erro ao carregar dados:", e);
                    document.getElementById('baskets-list').innerHTML = '<div style="padding:40px; text-align:center;">Erro ao carregar cat√°logo. Tente atualizar a p√°gina.</div>';
                }
            },

            renderTags() {
                const mobileList = document.getElementById('mobile-tags-list');
                const desktopList = document.getElementById('desktop-tags-list');
                
                const tagsHTML = APP_TAGS.map(tag => 
                    `<button class="tag-chip" onclick="App.searchByTag('${tag}')">${tag}</button>`
                ).join('');
                
                const mobileTagsHTML = APP_TAGS.map(tag => 
                    `<div class="tag-btn-mobile" onclick="App.searchByTag('${tag}')">${tag}</div>`
                ).join('');

                if(mobileList) mobileList.innerHTML = mobileTagsHTML;
                if(desktopList) desktopList.innerHTML = tagsHTML;
            },

            searchByTag(tag) {
                this.searchTerm = tag.toLowerCase();
                const searchInput = document.getElementById('product-search');
                if(searchInput) searchInput.value = tag;
                this.renderCustomizerLists(true);
                document.getElementById('tags-sheet').classList.remove('open');
                
                setTimeout(() => {
                    const section = document.querySelector('.extras-separator-banner');
                    if(section) {
                        const headerOffset = 150; 
                        const elementPosition = section.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.scrollY - headerOffset;
                        window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                    }
                }, 100);
            },

            toggleTagsSheet() { document.getElementById('tags-sheet').classList.toggle('open'); },
            toggleOffersSheet() { 
                const sheet = document.getElementById('offers-sheet');
                sheet.classList.toggle('open');
                if(sheet.classList.contains('open')) {
                    this.renderOffersSheet();
                }
            },

            renderOffersSheet() {
                const container = document.getElementById('mobile-offers-list');
                const offers = this.data.filter(p => p.isOffer);
                if(offers.length === 0) {
                    container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:20px;">Nenhuma oferta no momento.</div>';
                    return;
                }
                container.innerHTML = offers.map(p => this.renderProductCard(p, false)).join('');
                setTimeout(() => this.setupMediaObserver(), 100);
            },

            setupScroll() {
                const topBtn = document.getElementById('btn-scroll-top');
                const appNav = document.getElementById('mobile-app-bar');
                
                let lastY = 0;
                
                window.addEventListener('scroll', () => {
                    const y = window.scrollY;
                    if (y > 60 && y > lastY) document.body.classList.add('header-hidden');
                    else document.body.classList.remove('header-hidden');
                    lastY = y;

                    if (y > 300) {
                        topBtn.classList.add('visible');
                        if(this.currentBasket) {
                            if(appNav && window.innerWidth < 1024) appNav.style.display = 'grid';
                        }
                    } else {
                        topBtn.classList.remove('visible');
                    }
                });
            },

            renderHome() {
                const container = document.getElementById('baskets-list');
                const cestas = this.data.filter(p => p.categoria === 'CESTA B√ÅSICA');
                container.innerHTML = cestas.map((p, index) => {
                    const loadingAttr = index < 2 ? 'eager' : 'lazy';
                    const fetchPriority = index < 2 ? 'high' : 'auto';
                    const displayPrice = (p.isOffer && p.offerPrice > 0) ? p.offerPrice : p.valor;

                    return `
                    <article class="big-card">
                        <div class="bc-image-box" onclick="Gallery.open('${p.imagem}', '${p.nome}')">
                            <img src="${p.imagem}" alt="Cesta B√°sica ${p.nome}" class="bc-image img-fade-in" width="500" height="500" loading="${loadingAttr}" fetchpriority="${fetchPriority}" onload="this.classList.add('visible')">
                            <div class="media-indicators" id="media-ind-home-${p.id}">
                                <div class="indicator-icon camera-icon"><svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div>
                                <div class="indicator-icon video-icon"><svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></div>
                            </div>
                        </div>
                        <div class="bc-content">
                            <h2 class="bc-title">${p.nome}</h2>
                            <div class="bc-price">R$ ${displayPrice.toFixed(2).replace('.', ',')}</div>
                            <div class="bc-actions">
                                <button class="btn-full btn-customize" onclick="App.openCustomizer('${p.id}')">
                                    <span>Personalizar</span>
                                </button>
                                <button class="btn-full btn-whatsapp-outline" onclick="App.directOrder('${p.id}')">
                                    <span>Pedir Direto</span>
                                </button>
                            </div>
                        </div>
                    </article>
                `}).join('');
                
                setTimeout(() => this.setupMediaObserver('home-'), 100);
            },

            openCustomizer(basketId) {
                const basket = this.data.find(p => p.id === basketId);
                if (!basket) return;
                this.currentBasket = basket;
                this.cart = {};
                this.searchTerm = "";
                document.getElementById('product-search').value = "";

                if (basket.items && Array.isArray(basket.items)) {
                    basket.items.forEach(item => {
                        let productMatch = null;
                        if (item.id) {
                            productMatch = this.data.find(p => p.id === String(item.id));
                        }
                        if (!productMatch && (item.nome || typeof item === 'string')) {
                            const nameToSearch = (item.nome || item).toString().toLowerCase();
                            productMatch = this.data.find(p => p.categoria !== 'CESTA B√ÅSICA' && p.nome.toLowerCase() === nameToSearch);
                            if (!productMatch) {
                                const firstWord = nameToSearch.split(' ')[0];
                                if (firstWord.length > 3) { 
                                    productMatch = this.data.find(p => p.categoria !== 'CESTA B√ÅSICA' && p.nome.toLowerCase().includes(firstWord));
                                }
                            }
                        }
                        if (productMatch) {
                            const qty = parseInt(item.qty || item.qtd || 1);
                            this.cart[productMatch.id] = (this.cart[productMatch.id] || 0) + qty;
                        }
                    });
                }
                
                this.originalCart = {...this.cart};
                
                const nameKey = basket.nome.toLowerCase().replace('cesta', '').trim();
                let limitKey = Object.keys(BASKET_LIMITS).find(k => nameKey.includes(k));
                this.currentLimit = limitKey ? BASKET_LIMITS[limitKey] : 99;

                let sumItems = 0;
                for(let id in this.cart) {
                    let p = this.data.find(x => x.id === id);
                    if(p) {
                         const price = (p.isOffer && p.offerPrice > 0) ? p.offerPrice : p.valor;
                         sumItems += price * this.cart[id];
                    }
                }
                
                this.baseFee = basket.valor - sumItems;

                document.getElementById('cust-basket-name').innerText = basket.nome;
                document.getElementById('home-view').classList.add('hidden');
                document.getElementById('customizer-view').classList.remove('hidden');
                
                // SHOW MOBILE APP BAR
                if(window.innerWidth < 1024) document.getElementById('mobile-app-bar').style.display = 'grid';

                window.scrollTo(0,0);
                this.renderCustomizerLists(true);
            },

            showHome() {
                document.getElementById('customizer-view').classList.add('hidden');
                document.getElementById('home-view').classList.remove('hidden');
                document.getElementById('mobile-app-bar').style.display = 'none';
                document.getElementById('credit-toast').classList.remove('visible');
                this.currentBasket = null;
            },

            renderCustomizerLists(fullRender = false) {
                this.renderBasketSummary(); 
                if (fullRender) {
                    this.renderCatalog(); 
                }
                this.updateUIStatus(); 
            },

            renderBasketSummary() {
                const basketContainer = document.getElementById('basket-items-container');
                let basketItems = Object.keys(this.cart).map(id => this.data.find(x => x.id === id)).filter(p => p);
                
                if (basketItems.length === 0) basketContainer.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:20px; color:#999;">Cesta vazia</div>';
                else {
                    basketContainer.innerHTML = basketItems.map(p => {
                        return this.renderProductCard(p, true);
                    }).join('');
                }
            },

            renderCatalog() {
                const othersContainer = document.getElementById('other-items-container');
                const catListDesktop = document.getElementById('desktop-cat-list');
                const catListMobile = document.getElementById('mobile-cat-list');

                let extras = this.data.filter(p => p.categoria !== 'CESTA B√ÅSICA' && (!this.searchTerm || p.nome.toLowerCase().includes(this.searchTerm)));
                
                let groups = {};
                extras.forEach(p => { if(!groups[p.categoria]) groups[p.categoria]=[]; groups[p.categoria].push(p); });
                let cats = Object.keys(groups).sort();
                this.categories = cats;

                const navHTML = cats.map(c => `<a class="desktop-cat-link cat-link" onclick="App.scrollToCat('${c}')">${c}</a>`).join('');
                if (catListDesktop) catListDesktop.innerHTML = navHTML;
                if (catListMobile) catListMobile.innerHTML = navHTML;

                let html = '';
                if(extras.length === 0) html = '<div style="text-align:center; padding:40px;">Nenhum produto encontrado.</div>';
                else {
                    cats.forEach(c => {
                        let themeKey = Object.keys(CATEGORY_THEMES).find(k => c.toUpperCase().includes(k)) || 'DEFAULT';
                        let theme = CATEGORY_THEMES[themeKey];

                        html += `
                        <div id="cat-${c}" style="scroll-margin-top:140px;">
                            <div class="section-banner" style="background-color: ${theme.bar}; color: ${theme.text};">
                                <h3>${c}</h3>
                                <p style="color:${theme.text}; opacity:0.7;">Toque para adicionar</p>
                            </div>
                            <div class="category-box" style="background-color: #ffffff;">
                                <div class="extras-grid">`;
                        html += groups[c].map(p => this.renderProductCard(p, false)).join('');
                        html += `</div></div></div>`; 
                    });
                }
                othersContainer.innerHTML = html;
                setTimeout(() => this.setupMediaObserver(), 500);
            },

            getButtonHtml(id, qty, productName) {
                const safeName = productName ? productName.replace(/"/g, '&quot;') : '';
                
                if (!qty || qty === 0) {
                    return `<button class="btn-add-sm" onclick="App.changeQty('${id}', 1)" aria-label="Adicionar ${safeName}">Adicionar</button>`;
                } else {
                    return `<div class="qty-control">
                            <button class="qty-btn" onclick="App.changeQty('${id}', -1)" aria-label="Remover 1 ${safeName}">-</button>
                            <span class="qty-val">${qty}</span>
                            <button class="qty-btn" onclick="App.changeQty('${id}', 1)" aria-label="Adicionar 1 ${safeName}">+</button>
                        </div>`;
                }
            },

            renderProductCard(p, isIncluded) {
                let qty = this.cart[p.id] || 0;
                let btnHtml = this.getButtonHtml(p.id, qty, p.nome);
                
                let priceHTML = '';
                if (p.isOffer && p.offerPrice > 0) {
                    priceHTML = `
                        <div class="price-container">
                            <span class="price-old">R$ ${p.valor.toFixed(2).replace('.', ',')}</span>
                            <span class="price-new">R$ ${p.offerPrice.toFixed(2).replace('.', ',')}</span>
                        </div>
                    `;
                } else {
                    priceHTML = `<div class="pc-price">R$ ${p.valor.toFixed(2).replace('.', ',')}</div>`;
                }

                let offerTag = (p.isOffer && p.offerPrice > 0) ? `<div class="pc-offer-tag">OFERTA</div>` : '';
                let uniqueContext = isIncluded ? 'inc' : 'ext'; 

                let validityHTML = '';
                let nutriBtnHTML = '';
                let featuresBtnHTML = '';

                if (p.categoria === 'ALIMENTOS') {
                    if (p.validade) {
                        validityHTML = `<div class="pc-validity">Validade: ${p.validade}</div>`;
                    }
                    const lastDot = p.imagem.lastIndexOf('.');
                    if (lastDot > -1) {
                        const base = p.imagem.substring(0, lastDot);
                        const ext = p.imagem.substring(lastDot);
                        const nutriSrc = base + 'A' + ext;
                        nutriBtnHTML = `<button id="nutri-btn-${p.id}" class="btn-nutri" onclick="Gallery.open('${p.imagem}', '${p.nome.replace(/"/g, '&quot;')}', '${nutriSrc}')">
                            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right:4px"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            Valor Nutricional
                        </button>`;
                    }
                }
                
                if (p.caracteristicas) {
                    const safeDesc = p.caracteristicas.replace(/"/g, '&quot;').replace(/'/g, "\\'").replace(/\n/g, '\\n').replace(/\r/g, '');
                    featuresBtnHTML = `<button class="btn-features" onclick="App.openFeatures('${safeDesc}', '${p.nome.replace(/"/g, '&quot;')}')">
                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> 
                        Caracter√≠sticas
                    </button>`;
                }

                return `
                    <article class="product-card" data-pid="${p.id}">
                        <div class="pc-img-box" onclick="Gallery.open('${p.imagem}', '${p.nome}')">
                            ${offerTag}
                            <img src="${p.imagem}" alt="${p.nome}" class="pc-img img-fade-in" loading="lazy" decoding="async" width="200" height="200" onload="this.classList.add('visible')">
                            <div class="media-indicators" id="media-ind-${p.id}">
                                <div class="indicator-icon camera-icon"><svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div>
                                <div class="indicator-icon video-icon"><svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></div>
                            </div>
                        
                        <h3 class="pc-name">${p.nome}</h3>
                        ${validityHTML}
                        ${isIncluded ? `<div class="pc-meta">Incluso</div>` : priceHTML}
                        ${featuresBtnHTML}
                        ${nutriBtnHTML}
                        <div class="pc-actions" id="btn-area-${p.id}-${uniqueContext}">${btnHtml}</div>
                    </article>`;
            },

            setupMediaObserver(prefix = '') {
                const containers = document.querySelectorAll(`[id^='media-ind-${prefix}']`);
                const observer = new IntersectionObserver((entries, obs) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const el = entry.target;
                            this.performMediaCheck(el, prefix);
                            obs.unobserve(el);
                        }
                    });
                }, { rootMargin: '200px' });
                containers.forEach(el => observer.observe(el));
            },

            performMediaCheck(container, prefix) {
                const pid = container.id.replace('media-ind-' + prefix, '').replace('media-ind-', '');
                const p = this.data.find(x => x.id === pid);
                if(p && p.imagem) {
                    const lastDot = p.imagem.lastIndexOf('.');
                    if(lastDot > -1) {
                        const base = p.imagem.substring(0, lastDot);
                        const testUrlImg = base + 'A' + p.imagem.substring(lastDot);
                        const img = new Image();
                        img.onload = () => { 
                            if(img.naturalWidth > 0) {
                                const camIcon = container.querySelector('.camera-icon');
                                if(camIcon) camIcon.classList.add('visible');
                                const nutriBtns = document.querySelectorAll(`[id='nutri-btn-${pid}']`);
                                nutriBtns.forEach(btn => btn.style.display = 'inline-flex');
                            }
                        };
                        img.src = testUrlImg;
                        const testUrlVideo = base + '.mp4';
                        const video = document.createElement('video');
                        video.preload = 'metadata'; 
                        video.onloadedmetadata = () => {
                            const vidIcon = container.querySelector('.video-icon');
                            if(vidIcon) vidIcon.classList.add('visible');
                        };
                        video.src = testUrlVideo;
                    }
                }
            },

            countRemovals() {
                let removals = 0;
                for(let id in this.originalCart) {
                    if (this.originalCart[id] > 0 && (!this.cart[id] || this.cart[id] === 0)) {
                        removals++;
                    }
                }
                return removals;
            },

            changeQty(id, delta) {
                const product = this.data.find(p => p.id === id);
                if (!product) return;

                const currentQty = this.cart[id] || 0;
                const newQty = currentQty + delta;
                
                if (delta > 0) {
                    let maxAllowed = product.estoque;
                    if (product.limit > 0) maxAllowed = Math.min(product.estoque, product.limit);
                    if (newQty > maxAllowed) {
                        alert(`Quantidade m√°xima atingida para este produto.\nEstoque: ${product.estoque}\nLimite por cliente: ${product.limit > 0 ? product.limit : 'Ilimitado'}`);
                        return;
                    }
                }

                if (this.originalCart[id] && delta < 0 && newQty === 0) {
                    const currentRemovals = this.countRemovals();
                    if (currentRemovals >= this.currentLimit) {
                        alert(`Voc√™ atingiu o limite de ${this.currentLimit} trocas/exclus√µes permitidas para esta cesta.`);
                        return;
                    }
                }

                if(!this.cart[id]) this.cart[id] = 0;
                this.cart[id] += delta;
                if(this.cart[id] <= 0) delete this.cart[id];

                this.renderBasketSummary();

                const extrasBtn = document.getElementById(`btn-area-${id}-ext`);
                if (extrasBtn) extrasBtn.innerHTML = this.getButtonHtml(id, this.cart[id] || 0, product.nome);
                
                // Also update button in offers list if present
                if(document.getElementById('offers-sheet').classList.contains('open')) {
                   this.renderOffersSheet();
                }

                this.updateUIStatus();
            },

            updateUIStatus() {
                const badge = document.getElementById('changes-badge');
                const removals = this.countRemovals();
                
                if (badge) {
                    badge.innerText = `Exclu√≠dos: ${removals}/${this.currentLimit}`;
                    badge.style.display = 'flex';
                    if(removals >= this.currentLimit) badge.classList.add('limit-reached');
                    else badge.classList.remove('limit-reached');
                }

                this.updateTotal();
            },

            updateTotal() {
                let itemsSum = 0;
                for(let id in this.cart) {
                    let p = this.data.find(x => x.id === id);
                    if(p) {
                         const price = (p.isOffer && p.offerPrice > 0) ? p.offerPrice : p.valor;
                         itemsSum += price * this.cart[id];
                    }
                }

                const originalPrice = this.currentBasket.valor;
                let calculatedTotal = itemsSum + this.baseFee;
                let finalTotal = Math.max(calculatedTotal, originalPrice);
                
                let credit = 0;
                if (calculatedTotal < originalPrice) {
                    credit = originalPrice - calculatedTotal;
                }

                const totalStr = 'R$ ' + finalTotal.toFixed(2).replace('.', ',');
                
                if(document.getElementById('ff-total-val')) document.getElementById('ff-total-val').innerText = totalStr;
                if(document.getElementById('header-total-val')) document.getElementById('header-total-val').innerText = totalStr;
                
                const toast = document.getElementById('credit-toast');
                if (credit > 0) {
                    document.getElementById('credit-text').innerText = `Cr√©dito para gastar: R$ ${credit.toFixed(2).replace('.', ',')}`;
                    toast.classList.add('visible');
                } else {
                    toast.classList.remove('visible');
                }

                return finalTotal;
            },

            toggleCategorySheet() { document.getElementById('cat-sheet').classList.toggle('open'); },
            toggleFAQSheet() { document.getElementById('faq-sheet').classList.toggle('open'); },
            toggleFeatures() { document.getElementById('char-sheet').classList.toggle('open'); },
            
            openFeatures(text, title) {
                document.getElementById('char-title').innerText = "Caracter√≠sticas: " + title;
                document.getElementById('char-body').innerText = text;
                this.toggleFeatures();
            },

            scrollToCat(cat) {
                const el = document.getElementById('cat-'+cat);
                if(el) {
                    window.scrollTo({top: el.offsetTop - 140, behavior: 'smooth'});
                    document.getElementById('cat-sheet').classList.remove('open');
                }
            },

            openCheckout() {
                if(Object.keys(this.cart).length === 0) return alert("Sua cesta est√° vazia.");
                const listEl = document.getElementById('checkout-list');
                listEl.innerHTML = '';
                let total = this.updateTotal();
                for(let id in this.cart) {
                    let p = this.data.find(x => x.id === id);
                    if(p) {
                        listEl.innerHTML += `<li class="checkout-item"><span>${this.cart[id]}x ${p.nome}</span></li>`;
                    }
                }
                document.getElementById('checkout-total').innerText = 'R$ ' + total.toFixed(2).replace('.', ',');
                document.getElementById('checkout-modal').showModal();
            },

            confirmCheckout() {
                const payment = document.querySelector('input[name="payment"]:checked').value;
                const totalStr = document.getElementById('checkout-total').innerText;
                
                let msg = `*NOVO PEDIDO: ${this.currentBasket.nome}*\n--------------------------------\n`;
                msg += `*ITENS DA CESTA:*\n`;
                for(let id in this.cart) {
                    let p = this.data.find(x => x.id === id);
                    if(p) msg += `${this.cart[id]}x ${p.nome}\n`;
                }
                
                msg += `--------------------------------\n`;
                msg += `*TOTAL FINAL: ${totalStr}*\n`;
                msg += `*FORMA DE PAGAMENTO:* ${payment}\n`;
                
                window.open(`https://api.whatsapp.com/send?phone=${this.phone}&text=${encodeURIComponent(msg)}`, '_blank');
                document.getElementById('checkout-modal').close();
            },

            directOrder(id) {
                const p = this.data.find(x => x.id === id);
                let msg = `Ol√°! Gostaria de pedir a *${p.nome}* diretamente.`;
                window.open(`https://api.whatsapp.com/send?phone=${this.phone}&text=${encodeURIComponent(msg)}`, '_blank');
            }
        };

        document.addEventListener('DOMContentLoaded', () => { App.init(); });
    </script>
</body>
</html>
